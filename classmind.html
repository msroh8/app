<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù†Ø¸Ø§Ù… Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø­ØµØµ - Ø«Ø§Ù†ÙˆÙŠØ© Ø¯Ø§Ø± Ø§Ù„ØªÙˆØ­ÙŠØ¯</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap');
        body { font-family: 'Tajawal', sans-serif; background-color: #f1f5f9; touch-action: manipulation; }
        
        /* Ù…ÙŠØ²Ø© ØªØ«Ø¨ÙŠØª Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø§Ø³Ù… Ù„Ù„Ø¬ÙˆØ§Ù„ */
        .sticky-col {
            position: sticky;
            right: 0;
            background-color: white;
            z-index: 10;
            box-shadow: -2px 0 5px rgba(0,0,0,0.05);
        }

        /* Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø­ØµØµ */
        .state-0 { background-color: #f8fafc; color: #94a3b8; } 
        .state-1 { background-color: #22c55e !important; color: white !important; } 
        .state-2 { background-color: #f59e0b !important; color: white !important; } 
        .state-3 { background-color: #ef4444 !important; color: white !important; } 
        .state-4 { background-color: #000000 !important; color: white !important; font-weight: bold; } 

        .duty-none { background-color: #e2e8f0; color: #64748b; border: 1px solid #cbd5e1; }
        .duty-active { background-color: #3b82f6; color: white; border: 1px solid #2563eb; }
        .duty-super { background-color: #8b5cf6; color: white; border: 1px solid #7c3aed; }

        @media print {
            .no-print { display: none !important; }
            body { background-color: white !important; padding: 0 !important; }
            .sticky-col { position: static !important; box-shadow: none !important; }
            th { background-color: #1e3a8a !important; color: white !important; -webkit-print-color-adjust: exact; }
            td { border: 1px solid #cbd5e1 !important; -webkit-print-color-adjust: exact; padding: 10px !important; }
            .report-header { background: linear-gradient(to left, #1e3a8a, #3b82f6) !important; color: white !important; -webkit-print-color-adjust: exact; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
        }
    </style>
</head>
<body class="p-2 md:p-6 text-sm">

    <div class="max-w-[1400px] mx-auto bg-white shadow-lg rounded-xl overflow-hidden mb-4 no-print border-t-4 border-blue-900">
        <div class="bg-blue-900 text-white p-4 text-center md:text-right md:flex justify-between items-center">
            <div>
                <h1 class="text-xl font-bold">Ù†Ø¸Ø§Ù… ØªØªØ¨Ø¹ Ø§Ù„Ø­ØµØµ</h1>
                <p class="text-xs text-blue-200">Ø«Ø§Ù†ÙˆÙŠØ© Ø¯Ø§Ø± Ø§Ù„ØªÙˆØ­ÙŠØ¯ | Ø³Ù„Ø·Ø§Ù† Ø§Ù„Ø®Ø¯ÙŠØ¯ÙŠ</p>
            </div>
            <div class="flex justify-center gap-2 mt-3 md:mt-0">
                <button onclick="window.print()" class="bg-blue-600 p-2 px-4 rounded-lg text-xs font-bold shadow hover:bg-blue-700 transition">
                    <i class="fas fa-print ml-1"></i> Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¹Ø§Ù…
                </button>
                <button onclick="addNewTeacher()" class="bg-emerald-600 p-2 px-4 rounded-lg text-xs font-bold shadow hover:bg-emerald-700 transition">
                    <i class="fas fa-plus ml-1"></i> Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„Ù…
                </button>
            </div>
        </div>
        
        <div class="p-3 bg-blue-50 flex flex-wrap gap-3 items-center justify-between border-b">
            <div class="flex gap-2 items-center w-full md:w-auto">
                <select id="dayOfWeek" class="border rounded p-1.5 font-bold flex-1 md:flex-none">
                    <option>Ø§Ù„Ø£Ø­Ø¯</option><option>Ø§Ù„Ø§Ø«Ù†ÙŠÙ†</option><option>Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡</option><option>Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</option><option>Ø§Ù„Ø®Ù…ÙŠØ³</option>
                </select>
                <input type="date" id="reportDate" class="border rounded p-1.5 flex-1 md:flex-none">
            </div>
            <div class="hidden md:block text-[10px] text-blue-500 italic font-bold">
                <i class="fas fa-mobile-alt ml-1"></i> Ù†Ø³Ø®Ø© Ù…Ø·ÙˆØ±Ø© Ù„Ù„Ø¬ÙˆØ§Ù„ (Ø§Ø³Ø­Ø¨ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù„Ù„ÙŠØ³Ø§Ø± Ù„Ù„Ø±ØµØ¯)
            </div>
        </div>
    </div>

    <div class="max-w-[1400px] mx-auto bg-white shadow-md rounded-lg overflow-hidden border">
        <div class="hidden print:block report-header text-center">
            <div class="flex justify-between items-center px-4">
                <div class="text-right text-xs">Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©<br>ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…<br>Ø«Ø§Ù†ÙˆÙŠØ© Ø¯Ø§Ø± Ø§Ù„ØªÙˆØ­ÙŠØ¯</div>
                <div class="text-center">
                    <h2 class="text-xl font-bold underline decoration-yellow-400">ØªÙ‚Ø±ÙŠØ± Ø±ØµØ¯ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„ÙŠÙˆÙ…ÙŠ</h2>
                    <p id="printInfo" class="mt-2 text-sm font-semibold"></p>
                </div>
                <div class="w-24"></div>
            </div>
        </div>

        <div class="overflow-x-auto relative shadow-inner">
            <table class="w-full text-right border-collapse min-w-[800px]">
                <thead>
                    <tr class="bg-slate-800 text-white print:bg-blue-900">
                        <th class="p-3 sticky-col border-b border-slate-700 whitespace-nowrap">Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…</th>
                        <th class="p-2 border-b border-slate-700 text-center w-10">Ø­1</th>
                        <th class="p-2 border-b border-slate-700 text-center w-10">Ø­2</th>
                        <th class="p-2 border-b border-slate-700 text-center w-10">Ø­3</th>
                        <th class="p-2 border-b border-slate-700 text-center w-10">Ø­4</th>
                        <th class="p-2 border-b border-slate-700 text-center w-10">Ø­5</th>
                        <th class="p-2 border-b border-slate-700 text-center w-10">Ø­6</th>
                        <th class="p-2 border-b border-slate-700 text-center w-10">Ø­7</th>
                        <th class="p-2 border-b border-slate-700 text-center min-w-[160px]">Ø§Ù„Ù…Ù†Ø§ÙˆØ¨Ø©/Ø§Ù„Ø¥Ø´Ø±Ø§Ù</th>
                        <th class="p-2 border-b border-slate-700 text-center no-print">ØªØµØ¯ÙŠØ±</th>
                    </tr>
                </thead>
                <tbody id="teacherTableBody"></tbody>
            </table>
        </div>

        <div class="hidden print:grid grid-cols-2 gap-10 mt-10 pb-10 text-center font-bold border-t pt-6">
            <div>
                ÙˆÙƒÙŠÙ„ Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ù„Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©<br>
                <span class="text-blue-900 text-lg">Ø³Ù„Ø·Ø§Ù† Ø§Ù„Ø®Ø¯ÙŠØ¯ÙŠ</span>
            </div>
            <div>
                Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©<br>
                <span class="text-blue-900 text-lg">ÙÙ‡Ø¯ Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ</span>
            </div>
        </div>
    </div>

    <script>
        let teachers = [
            "Ø¹Ù„ÙŠ Ù…Ø­Ù…Ø¯ Ø§Ù„Ù‚Ø±Ù†ÙŠ", "Ø³Ø¹ÙŠØ¯ Ø§Ø­Ù…Ø¯ ÙŠØ­ÙŠÙ‰ Ø§Ù„Ø²Ù‡Ø±Ø§Ù†ÙŠ", "ÙŠØ­ÙŠÙ‰ Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… ÙŠØ­ÙŠÙ‰ Ø¯ØºØ±ÙŠØ±ÙŠ",
            "Ø§Ø­Ù…Ø¯ Ø¹Ø§Ø¨Ø¯ Ø§Ù„Ø±Ù‚ÙŠØ¨", "Ù…Ø´Ø§Ø±ÙŠ Ø®Ø§Ù„Ø¯ Ø±ÙŠØ­Ø§Ù† Ø§Ù„Ø­Ø§Ø±Ø«ÙŠ", "Ø¶ÙŠÙ Ø§Ù„Ù„Ù‡ Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø§Ù„Ù†Ù…Ø±ÙŠ",
            "Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡ ØµØ§ÙŠÙ„ Ø®Ù„ÙŠÙˆÙŠ Ø§Ù„Ø­Ø§Ø±Ø«ÙŠ", "Ø³Ø¹ÙˆØ¯ Ø¯Ø®ÙŠÙ„ Ø§Ù„Ù„Ù‡ Ù‡Ù„Ø§Ù„ Ø§Ù„Ù‚Ø±Ø´ÙŠ", "Ø³Ø¹ÙŠØ¯ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ø­ÙˆØªØ§Ù†ÙŠ",
            "Ø¹Ø§ØµÙ… Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡ Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ", "Ù†Ø§ØµØ± Ø¹ÙˆØ¶ Ù…Ø¹ÙŠØ¶ Ø§Ù„Ø«Ø¨ÙŠØªÙŠ", "Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø­Ù…Ù† Ø¹Ù„ÙŠ Ø¹Ø«Ù…Ø§Ù† Ø§Ù„Ø´Ù‡Ø±ÙŠ",
            "Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡ Ø§Ù„Ø¬Ø¹ÙŠØ¯", "Ù…Ø­Ù…Ø¯ Ù…Ù†ØµÙˆØ± Ù…Ø¬Ù…Ù…ÙŠ", "Ø±Ø§Ø¦Ø¯ Ø£Ø­Ù…Ø¯ Ø§Ù„Ø·ÙˆÙŠØ±Ù‚ÙŠ",
            "Ø¹Ù„ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø­Ø³Ù† Ø²ÙŠØ¯ Ø§Ù„Ø­Ø§Ø±Ø«ÙŠ", "Ø·Ù„Ø§Ù„ Ù…Ø­Ù…Ø¯ Ø­Ø§Ù…Ø¯ Ø§Ù„Ø³ÙÙŠØ§Ù†ÙŠ", "ÙØ§ÙŠØ² Ø¹ÙŠØ¶Ø© Ù…Ø¹ÙŠÙˆØ¶ Ø§Ù„Ø¨Ø±Ø§Ù‚",
            "Ø§Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø§Ù„Ø«Ù…Ø§Ù„ÙŠ", "ÙÙˆØ§Ø² Ù…Ø·Ù„Ù‚ Ù…Ø¹ÙŠÙˆØ¶ Ø§Ù„Ø­ØµÙŠÙ†ÙŠ", "Ø¨Ø¯Ø± Ø³Ø¹ÙŠØ¯ Ø¹ÙˆØ¶ Ø§Ù„Ø­Ø§Ø±Ø«ÙŠ",
            "ÙÙŠØµÙ„ Ø¹Ù„ÙŠ Ù…ØºØ±Ù… Ø§Ù„Ø´Ù‡Ø±ÙŠ", "Ù…Ø´Ø¹Ù„ ÙØ±Ø¬ Ø¬Ø§Ø± Ø§Ù„Ù†Ø¨ÙŠ Ø§Ù„Ø¨Ø±Ø¯ÙŠ", "Ø´Ø§ÙƒØ± Ø³Ø¹Ø¯ Ø§Ù„Ø²Ø§ÙŠØ¯ÙŠ",
            "Ø£Ø­Ù…Ø¯ Ø­Ø³Ù† Ø¹Ù„ÙŠ Ø§Ù„Ø²Ù‡Ø±Ø§Ù†ÙŠ", "ØªØ±ÙƒÙŠ Ø¹Ø§Ù„ÙŠ Ø§Ù„Ù‚ØµÙŠÙˆÙŠ", "Ù†Ø§ÙŠÙ Ù…Ø¹ÙŠÙˆØ¶ Ø±Ø¯Ù‡ Ø§Ù„Ø«Ø¨ÙŠØªÙŠ",
            "Ø³Ø§Ù…ÙŠ Ø³Ø¹ÙŠØ¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ", "Ù‡Ø§Ù†ÙŠ Ø®Ù„Ù Ø¬Ø¨Ø±Ø§Ù† Ø§Ù„Ù‚Ø±Ø´ÙŠ", "Ø¹ÙˆØ§Ø¶ Ø¹Ø¨Ø¯Ø§Ù„Ù‡Ø§Ø¯ÙŠ Ø§Ù„Ø«Ø¨ÙŠØªÙŠ",
            "Ø³Ù„Ø·Ø§Ù† Ù‡Ù„Ø§Ù„ Ø§Ù„Ø«Ø¨ÙŠØªÙŠ", "Ù…Ø­Ù…Ø¯ Ø³Ø¹Ø¯ Ø¹Ø¨Ø¯Ø§Ù„ØµÙ…Ø¯ Ø§Ù„ÙˆÙ‚Ø¯Ø§Ù†ÙŠ"
        ];

        const pStates = [
            { label: "-", class: "state-0" },
            { label: "âœ“", class: "state-1" }, 
            { label: "10Ø¯", class: "state-2" }, 
            { label: "10+", class: "state-3" }, 
            { label: "X", class: "state-4" } 
        ];

        const dStates = [
            { label: "ØºÙŠØ± Ù…ÙƒÙ„Ù", class: "duty-none" },
            { label: "Ù…Ù†Ø§ÙˆØ¨ âœ…", class: "duty-active" },
            { label: "Ù…Ø´Ø±Ù ğŸ›¡ï¸", class: "duty-super" }
        ];

        document.getElementById('reportDate').valueAsDate = new Date();

        function renderTable() {
            const tbody = document.getElementById('teacherTableBody');
            tbody.innerHTML = '';
            teachers.forEach((name, idx) => {
                const tr = document.createElement('tr');
                tr.className = "border-b hover:bg-blue-50/50 transition-colors";
                tr.innerHTML = `
                    <td class="p-3 font-bold text-slate-800 sticky-col border-x">${name}</td>
                    ${Array(7).fill().map(() => `<td onclick="cyclePState(this)" class="p-1 border text-center cursor-pointer font-bold text-[10px] h-11 w-11 state-0 transition-all select-none">-</td>`).join('')}
                    <td class="p-1 border text-center">
                        <button onclick="cycleDState(this)" data-state="0" class="w-full text-[10px] py-2 px-1 rounded-md font-bold duty-none transition-all">ØºÙŠØ± Ù…ÙƒÙ„Ù</button>
                    </td>
                    <td class="p-1 border text-center no-print">
                        <button onclick="printSingleCard('${name}', this)" class="text-blue-600 p-2">
                            <i class="fas fa-id-badge text-xl"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function cyclePState(el) {
            let s = (parseInt(el.dataset.state || 0) + 1) % pStates.length;
            el.dataset.state = s;
            el.innerText = pStates[s].label;
            el.className = `p-1 border text-center cursor-pointer font-bold text-[10px] h-11 w-11 transition-all select-none ${pStates[s].class}`;
        }

        function cycleDState(btn) {
            let s = (parseInt(btn.dataset.state) + 1) % dStates.length;
            btn.dataset.state = s;
            btn.innerText = dStates[s].label;
            btn.className = `w-full text-[10px] py-2 px-1 rounded-md font-bold transition-all ${dStates[s].class}`;
        }

        async function addNewTeacher() {
            const { value: name } = await Swal.fire({
                title: 'Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„Ù… Ø¬Ø¯ÙŠØ¯',
                input: 'text',
                confirmButtonColor: '#1e3a8a',
                confirmButtonText: 'Ø¥Ø¶Ø§ÙØ©',
                showCancelButton: true
            });
            if (name) {
                teachers.unshift(name);
                renderTable();
            }
        }

        window.onbeforeprint = () => {
            const day = document.getElementById('dayOfWeek').value;
            const date = document.getElementById('reportDate').value;
            document.getElementById('printInfo').innerText = `ÙŠÙˆÙ…: ${day} | Ø§Ù„ØªØ§Ø±ÙŠØ®: ${date}`;
        };

        function printSingleCard(name, btn) {
            const row = btn.closest('tr');
            const cells = row.querySelectorAll('td');
            const day = document.getElementById('dayOfWeek').value;
            const date = document.getElementById('reportDate').value;
            
            let cardHtml = `
                <div style="direction:rtl; padding:30px; border:8px double #1e3a8a; font-family:Tajawal, sans-serif; background-color: #fff;">
                    <div style="display:flex; justify-content:space-between; border-bottom:3px solid #1e3a8a; padding-bottom:15px; margin-bottom:20px;">
                        <div style="font-weight:bold; color:#1e3a8a;">Ø«Ø§Ù†ÙˆÙŠØ© Ø¯Ø§Ø± Ø§Ù„ØªÙˆØ­ÙŠØ¯</div>
                        <div style="text-align:center;">
                            <h1 style="margin:0; color:#1e3a8a;">Ø¨Ø·Ø§Ù‚Ø© Ù…ØªØ§Ø¨Ø¹Ø© Ø£Ø¯Ø§Ø¡</h1>
                        </div>
                        <div style="width:80px;"></div>
                    </div>
                    <p style="font-size:1.2rem; margin:0;"><b>Ø§Ù„Ù…Ø¹Ù„Ù…:</b> ${name}</p>
                    <p><b>ÙŠÙˆÙ…:</b> ${day} | <b>Ø§Ù„ØªØ§Ø±ÙŠØ®:</b> ${date}</p>
                    <table style="width:100%; border-collapse:collapse; text-align:center; border:2px solid #1e3a8a;">
                        <tr style="background:#1e3a8a; color:#fff;"><th>Ø­1</th><th>Ø­2</th><th>Ø­3</th><th>Ø­4</th><th>Ø­5</th><th>Ø­6</th><th>Ø­7</th></tr>
                        <tr style="font-weight:bold; font-size:1.1rem;">
                            <td style="border:1px solid #1e3a8a; padding:10px;">${cells[1].innerText}</td><td style="border:1px solid #1e3a8a;">${cells[2].innerText}</td>
                            <td style="border:1px solid #1e3a8a;">${cells[3].innerText}</td><td style="border:1px solid #1e3a8a;">${cells[4].innerText}</td>
                            <td style="border:1px solid #1e3a8a;">${cells[5].innerText}</td><td style="border:1px solid #1e3a8a;">${cells[6].innerText}</td>
                            <td style="border:1px solid #1e3a8a;">${cells[7].innerText}</td>
                        </tr>
                    </table>
                    <p style="margin-top:15px;"><b>Ø­Ø§Ù„Ø© Ø§Ù„Ø¥Ø´Ø±Ø§Ù:</b> ${cells[8].innerText}</p>
                    <div style="margin-top:40px; display:flex; justify-content:space-around; text-align:center;">
                        <div>ÙˆÙƒÙŠÙ„ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©<br><b>Ø³Ù„Ø·Ø§Ù† Ø§Ù„Ø®Ø¯ÙŠØ¯ÙŠ</b></div>
                        <div>Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©<br><b>ÙÙ‡Ø¯ Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ</b></div>
                    </div>
                </div>
            `;
            
            const win = window.open('', '', 'height=600,width=800');
            win.document.write('<html><head><title>ØªØµØ¯ÙŠØ±</title>');
            win.document.write('<style>@import url("https://fonts.googleapis.com/css2?family=Tajawal:wght@700&display=swap"); body{font-family:"Tajawal", sans-serif;}</style></head><body>');
            win.document.write(cardHtml + '</body></html>');
            win.document.close();
            setTimeout(() => { win.print(); }, 500);
        }

        renderTable();
    </script>
</body>
</html>
