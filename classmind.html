<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ØªØ·Ø¨ÙŠÙ‚ Ø«Ø§Ù†ÙˆÙŠØ© Ø¯Ø§Ø± Ø§Ù„ØªÙˆØ­ÙŠØ¯</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap');
        body { font-family: 'Tajawal', sans-serif; background-color: #f0f2f5; }
        
        /* ØªØ«Ø¨ÙŠØª Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø§Ø³Ù… Ù„Ù„Ø¬ÙˆØ§Ù„ */
        .sticky-col { position: sticky; right: 0; background: white; z-index: 20; border-left: 2px solid #ddd; }
        
        /* Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø­ØµØµ */
        .s-0 { background-color: #f8fafc; color: #94a3b8; }
        .s-1 { background-color: #22c55e !important; color: white !important; } /* Ø£Ø®Ø¶Ø± */
        .s-2 { background-color: #f59e0b !important; color: white !important; } /* Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ */
        .s-3 { background-color: #ef4444 !important; color: white !important; } /* Ø£Ø­Ù…Ø± */
        .s-4 { background-color: #000 !important; color: white !important; } /* X ØºÙŠØ§Ø¨ */

        @media print {
            .no-print { display: none !important; }
            body { background: white; padding: 0; }
            .sticky-col { position: static !important; border: 1px solid #000 !important; }
            table { width: 100% !important; border-collapse: collapse !important; }
            th, td { border: 1px solid #000 !important; padding: 8px !important; font-size: 11px !important; }
        }
    </style>
</head>
<body class="pb-24">

    <div class="no-print bg-blue-900 text-white p-4 sticky top-0 z-50 shadow-md">
        <div class="flex justify-between items-center max-w-5xl mx-auto">
            <div class="text-right">
                <h1 class="text-lg font-bold italic underline decoration-yellow-500">Ø«Ø§Ù†ÙˆÙŠØ© Ø¯Ø§Ø± Ø§Ù„ØªÙˆØ­ÙŠØ¯</h1>
                <p class="text-[10px] text-blue-300">Ù†Ø¸Ø§Ù… Ø§Ù„Ø±ØµØ¯ Ø§Ù„Ø°ÙƒÙŠ - Ù†Ø³Ø®Ø© 2026</p>
            </div>
            <div class="text-left text-[10px] leading-tight text-blue-100">
                ÙˆÙƒÙŠÙ„ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©: Ø³Ù„Ø·Ø§Ù† Ø§Ù„Ø®Ø¯ÙŠØ¯ÙŠ<br>Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©: ÙÙ‡Ø¯ Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ
            </div>
        </div>
        <div class="mt-4 flex gap-2">
            <div class="relative flex-1">
                <i class="fas fa-search absolute right-3 top-3 text-gray-400"></i>
                <input type="text" id="searchBox" onkeyup="doSearch()" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ø¹Ù„Ù…..." class="w-full p-2 pr-10 rounded-lg text-black text-sm outline-none focus:ring-2 focus:ring-yellow-500">
            </div>
            <select id="dayPicker" class="p-2 rounded-lg text-black text-sm font-bold bg-white">
                <option>Ø§Ù„Ø£Ø­Ø¯</option><option>Ø§Ù„Ø§Ø«Ù†ÙŠÙ†</option><option>Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡</option><option>Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</option><option>Ø§Ù„Ø®Ù…ÙŠØ³</option>
            </select>
        </div>
    </div>

    <div class="no-print overflow-x-auto mt-2">
        <table class="w-full bg-white text-right border-collapse min-w-[700px]">
            <thead class="bg-slate-700 text-white text-[10px]">
                <tr>
                    <th class="p-3 sticky-col">Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…</th>
                    <th class="p-1 border text-center">Ø­1</th><th class="p-1 border text-center">Ø­2</th><th class="p-1 border text-center">Ø­3</th>
                    <th class="p-1 border text-center">Ø­4</th><th class="p-1 border text-center">Ø­5</th><th class="p-1 border text-center">Ø­6</th>
                    <th class="p-1 border text-center">Ø­7</th><th class="p-1 border text-center min-w-[120px]">Ø§Ù„Ù…Ù†Ø§ÙˆØ¨Ø©/Ø§Ù„Ø¥Ø´Ø±Ø§Ù</th>
                    <th class="p-1 border text-center">Ø¨Ø·Ø§Ù‚Ø©</th>
                </tr>
            </thead>
            <tbody id="mainRows">
                </tbody>
        </table>
    </div>

    <div class="no-print fixed bottom-0 inset-x-0 bg-white border-t border-gray-200 p-3 flex justify-around items-center shadow-[0_-5px_15px_rgba(0,0,0,0.1)] z-50">
        <button onclick="addNewTeacher()" class="flex flex-col items-center group">
            <div class="p-2 bg-emerald-100 rounded-full group-active:scale-90 transition"><i class="fas fa-user-plus text-emerald-600 text-lg"></i></div>
            <span class="text-[10px] font-bold mt-1">Ø¥Ø¶Ø§ÙØ©</span>
        </button>
        <div class="text-center bg-blue-50 px-4 py-1 rounded-2xl border border-blue-100">
            <p id="todayDate" class="text-xs font-bold text-blue-900"></p>
        </div>
        <button onclick="window.print()" class="flex flex-col items-center group">
            <div class="p-2 bg-blue-100 rounded-full group-active:scale-90 transition"><i class="fas fa-print text-blue-600 text-lg"></i></div>
            <span class="text-[10px] font-bold mt-1">ØªÙ‚Ø±ÙŠØ± Ø¹Ø§Ù…</span>
        </button>
    </div>

    <div id="printContainer" class="hidden print:block p-6 bg-white"></div>

    <script>
        // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ† Ø§Ù„ÙƒØ§Ù…Ù„Ø©
        const initialTeachers = [
            "Ø¹Ù„ÙŠ Ù…Ø­Ù…Ø¯ Ø§Ù„Ù‚Ø±Ù†ÙŠ", "Ø³Ø¹ÙŠØ¯ Ø§Ø­Ù…Ø¯ ÙŠØ­ÙŠÙ‰ Ø§Ù„Ø²Ù‡Ø±Ø§Ù†ÙŠ", "ÙŠØ­ÙŠÙ‰ Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… ÙŠØ­ÙŠÙ‰ Ø¯ØºØ±ÙŠØ±ÙŠ",
            "Ø§Ø­Ù…Ø¯ Ø¹Ø§Ø¨Ø¯ Ø§Ù„Ø±Ù‚ÙŠØ¨", "Ù…Ø´Ø§Ø±ÙŠ Ø®Ø§Ù„Ø¯ Ø±ÙŠØ­Ø§Ù† Ø§Ù„Ø­Ø§Ø±Ø«ÙŠ", "Ø¶ÙŠÙ Ø§Ù„Ù„Ù‡ Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø§Ù„Ù†Ù…Ø±ÙŠ",
            "Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡ ØµØ§ÙŠÙ„ Ø®Ù„ÙŠÙˆÙŠ Ø§Ù„Ø­Ø§Ø±Ø«ÙŠ", "Ø³Ø¹ÙˆØ¯ Ø¯Ø®ÙŠÙ„ Ø§Ù„Ù„Ù‡ Ù‡Ù„Ø§Ù„ Ø§Ù„Ù‚Ø±Ø´ÙŠ", "Ø³Ø¹ÙŠØ¯ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ø­ÙˆØªØ§Ù†ÙŠ",
            "Ø¹Ø§ØµÙ… Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡ Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ", "Ù†Ø§ØµØ± Ø¹ÙˆØ¶ Ù…Ø¹ÙŠØ¶ Ø§Ù„Ø«Ø¨ÙŠØªÙŠ", "Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø­Ù…Ù† Ø¹Ù„ÙŠ Ø¹Ø«Ù…Ø§Ù† Ø§Ù„Ø´Ù‡Ø±ÙŠ",
            "Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡ Ø§Ù„Ø¬Ø¹ÙŠØ¯", "Ù…Ø­Ù…Ø¯ Ù…Ù†ØµÙˆØ± Ù…Ø¬Ù…Ù…ÙŠ", "Ø±Ø§Ø¦Ø¯ Ø£Ø­Ù…Ø¯ Ø§Ù„Ø·ÙˆÙŠØ±Ù‚ÙŠ",
            "Ø¹Ù„ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø­Ø³Ù† Ø²ÙŠØ¯ Ø§Ù„Ø­Ø§Ø±Ø«ÙŠ", "Ø·Ù„Ø§Ù„ Ù…Ø­Ù…Ø¯ Ø­Ø§Ù…Ø¯ Ø§Ù„Ø³ÙÙŠØ§Ù†ÙŠ", "ÙØ§ÙŠØ² Ø¹ÙŠØ¶Ø© Ù…Ø¹ÙŠÙˆØ¶ Ø§Ù„Ø¨Ø±Ø§Ù‚",
            "Ø§Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø§Ù„Ø«Ù…Ø§Ù„ÙŠ", "ÙÙˆØ§Ø² Ù…Ø·Ù„Ù‚ Ù…Ø¹ÙŠÙˆØ¶ Ø§Ù„Ø­ØµÙŠÙ†ÙŠ", "Ø¨Ø¯Ø± Ø³Ø¹ÙŠØ¯ Ø¹ÙˆØ¶ Ø§Ù„Ø­Ø§Ø±Ø«ÙŠ",
            "ÙÙŠØµÙ„ Ø¹Ù„ÙŠ Ù…ØºØ±Ù… Ø§Ù„Ø´Ù‡Ø±ÙŠ", "Ù…Ø´Ø¹Ù„ ÙØ±Ø¬ Ø¬Ø§Ø± Ø§Ù„Ù†Ø¨ÙŠ Ø§Ù„Ø¨Ø±Ø¯ÙŠ", "Ø´Ø§ÙƒØ± Ø³Ø¹Ø¯ Ø§Ù„Ø²Ø§ÙŠØ¯ÙŠ",
            "Ø£Ø­Ù…Ø¯ Ø­Ø³Ù† Ø¹Ù„ÙŠ Ø§Ù„Ø²Ù‡Ø±Ø§Ù†ÙŠ", "ØªØ±ÙƒÙŠ Ø¹Ø§Ù„ÙŠ Ø§Ù„Ù‚ØµÙŠÙˆÙŠ", "Ù†Ø§ÙŠÙ Ù…Ø¹ÙŠÙˆØ¶ Ø±Ø¯Ù‡ Ø§Ù„Ø«Ø¨ÙŠØªÙŠ",
            "Ø³Ø§Ù…ÙŠ Ø³Ø¹ÙŠØ¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ", "Ù‡Ø§Ù†ÙŠ Ø®Ù„Ù Ø¬Ø¨Ø±Ø§Ù† Ø§Ù„Ù‚Ø±Ø´ÙŠ", "Ø¹ÙˆØ§Ø¶ Ø¹Ø¨Ø¯Ø§Ù„Ù‡Ø§Ø¯ÙŠ Ø§Ù„Ø«Ø¨ÙŠØªÙŠ",
            "Ø³Ù„Ø·Ø§Ù† Ù‡Ù„Ø§Ù„ Ø§Ù„Ø«Ø¨ÙŠØªÙŠ", "Ù…Ø­Ù…Ø¯ Ø³Ø¹Ø¯ Ø¹Ø¨Ø¯Ø§Ù„ØµÙ…Ø¯ Ø§Ù„ÙˆÙ‚Ø¯Ø§Ù†ÙŠ"
        ];

        const pStates = [
            {l: "-", c: "s-0"}, {l: "âœ“", c: "s-1"}, {l: "10Ø¯", c: "s-2"}, {l: "+10", c: "s-3"}, {l: "X", c: "s-4"}
        ];
        
        const dStates = [
            {l: "ØºÙŠØ± Ù…ÙƒÙ„Ù Ø§Ù„ÙŠÙˆÙ…", c: "bg-gray-100 text-gray-500"},
            {l: "Ø­Ø¶Ø± Ø§Ù„Ù…Ù†Ø§ÙˆØ¨Ø© âœ…", c: "bg-blue-600 text-white font-bold"},
            {l: "Ù…Ø´Ø±Ù Ø§Ù„ÙŠÙˆÙ… ğŸ›¡ï¸", c: "bg-purple-600 text-white font-bold"}
        ];

        function buildTable() {
            const body = document.getElementById('mainRows');
            body.innerHTML = '';
            initialTeachers.forEach((name, i) => {
                let row = `
                    <tr class="border-b">
                        <td class="p-3 sticky-col font-bold text-[11px] whitespace-nowrap shadow-sm bg-white">${name}</td>
                        ${Array(7).fill().map(() => `<td onclick="toggleState(this)" class="p-1 border text-center cursor-pointer s-0 font-bold text-[10px] w-10 h-12" data-s="0">-</td>`).join('')}
                        <td class="p-1 border text-center">
                            <button onclick="toggleDuty(this)" data-d="0" class="text-[9px] w-full py-2 px-1 rounded bg-gray-100 font-bold">ØºÙŠØ± Ù…ÙƒÙ„Ù Ø§Ù„ÙŠÙˆÙ…</button>
                        </td>
                        <td class="p-1 border text-center">
                            <button onclick="exportSingleCard('${name}', this)" class="text-blue-500 hover:text-blue-800"><i class="fas fa-id-card text-xl"></i></button>
                        </td>
                    </tr>`;
                body.innerHTML += row;
            });
            document.getElementById('todayDate').innerText = new Date().toLocaleDateString('ar-SA');
        }

        function toggleState(el) {
            let s = (parseInt(el.dataset.s) + 1) % pStates.length;
            el.dataset.s = s;
            el.innerText = pStates[s].l;
            el.className = `p-1 border text-center cursor-pointer font-bold text-[10px] w-10 h-12 ${pStates[s].c}`;
        }

        function toggleDuty(btn) {
            let d = (parseInt(btn.dataset.d) + 1) % dStates.length;
            btn.dataset.d = d;
            btn.innerText = dStates[d].l;
            btn.className = `text-[9px] w-full py-2 px-1 rounded font-bold transition-all ${dStates[d].c}`;
        }

        function doSearch() {
            let q = document.getElementById('searchBox').value;
            let rows = document.querySelectorAll('#mainRows tr');
            rows.forEach(r => r.style.display = r.innerText.includes(q) ? '' : 'none');
        }

        async function addNewTeacher() {
            const { value: name } = await Swal.fire({ title: 'Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„Ù… Ø¬Ø¯ÙŠØ¯', input: 'text', confirmButtonText: 'Ø¥Ø¶Ø§ÙØ©', confirmButtonColor: '#1e3a8a' });
            if (name) { initialTeachers.unshift(name); buildTable(); }
        }

        // Ø¥Ø¹Ø¯Ø§Ø¯ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©
        window.onbeforeprint = () => {
            const container = document.getElementById('printContainer');
            const day = document.getElementById('dayPicker').value;
            const date = document.getElementById('todayDate').innerText;
            
            let html = `
                <div style="border:3px solid #1e3a8a; padding:15px; border-radius:10px; margin-bottom:20px; background:#f0f7ff;">
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <div style="font-size:12px;">Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©<br>ÙˆØ²Ø§Ø±Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…<br>Ø«Ø§Ù†ÙˆÙŠØ© Ø¯Ø§Ø± Ø§Ù„ØªÙˆØ­ÙŠØ¯</div>
                        <div style="text-align:center;">
                            <h1 style="margin:0; color:#1e3a8a;">ÙƒØ´Ù Ø±ØµØ¯ Ø§Ù„Ø­ØµØµ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ø§Ù„Ø´Ø§Ù…Ù„</h1>
                            <p style="font-weight:bold;">ÙŠÙˆÙ…: ${day} | Ø§Ù„ØªØ§Ø±ÙŠØ®: ${date}</p>
                        </div>
                        <div style="width:100px;"></div>
                    </div>
                </div>
                <table style="width:100%; border-collapse:collapse; text-align:center;">
                    <thead style="background:#1e3a8a; color:#fff;">
                        <tr><th>Ù…</th><th>Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…</th><th>Ø­1</th><th>Ø­2</th><th>Ø­3</th><th>Ø­4</th><th>Ø­5</th><th>Ø­6</th><th>Ø­7</th><th>Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¥Ø´Ø±Ø§ÙÙŠØ©</th></tr>
                    </thead>
                    <tbody>`;
            
            document.querySelectorAll('#mainRows tr').forEach((r, i) => {
                let cells = r.querySelectorAll('td');
                html += `<tr>
                    <td>${i+1}</td><td style="text-align:right; font-weight:bold;">${cells[0].innerText}</td>
                    <td>${cells[1].innerText}</td><td>${cells[2].innerText}</td><td>${cells[3].innerText}</td>
                    <td>${cells[4].innerText}</td><td>${cells[5].innerText}</td><td>${cells[6].innerText}</td>
                    <td>${cells[7].innerText}</td><td>${cells[8].innerText}</td>
                </tr>`;
            });

            html += `</tbody></table>
                <div style="display:flex; justify-content:space-around; margin-top:40px; text-align:center; font-weight:bold;">
                    <div>ÙˆÙƒÙŠÙ„ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©<br>Ø³Ù„Ø·Ø§Ù† Ø§Ù„Ø®Ø¯ÙŠØ¯ÙŠ<br>________________</div>
                    <div>Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©<br>ÙÙ‡Ø¯ Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ<br>________________</div>
                </div>
                <div style="text-align:center; font-size:10px; margin-top:30px; color:#666;">ÙÙƒØ±Ø© ÙˆØªÙ†ÙÙŠØ°: Ø³Ù„Ø·Ø§Ù† Ø§Ù„Ø®Ø¯ÙŠØ¯ÙŠ | Ø«Ø§Ù†ÙˆÙŠØ© Ø¯Ø§Ø± Ø§Ù„ØªÙˆØ­ÙŠØ¯</div>
            `;
            container.innerHTML = html;
        };

        // ØªØµØ¯ÙŠØ± Ø¨Ø·Ø§Ù‚Ø© ÙØ±Ø¯ÙŠØ© Ù…Ù„ÙˆÙ†Ø© Ù„Ù„Ù…Ø¹Ù„Ù…
        function exportSingleCard(name, btn) {
            const row = btn.closest('tr');
            const cells = row.querySelectorAll('td');
            const day = document.getElementById('dayPicker').value;
            const date = document.getElementById('todayDate').innerText;

            let cardHtml = `
                <div style="direction:rtl; padding:30px; border:15px double #1e3a8a; font-family:'Tajawal', sans-serif; background:white;">
                    <div style="display:flex; justify-content:space-between; border-bottom:4px solid #1e3a8a; padding-bottom:15px; margin-bottom:25px;">
                        <div style="font-weight:bold; color:#1e3a8a; font-size:14px;">Ø«Ø§Ù†ÙˆÙŠØ© Ø¯Ø§Ø± Ø§Ù„ØªÙˆØ­ÙŠØ¯</div>
                        <div style="text-align:center;">
                            <h1 style="margin:0; color:#1e3a8a; font-size:24px;">Ø¨Ø·Ø§Ù‚Ø© Ø£Ø¯Ø§Ø¡ Ù…Ø¹Ù„Ù… ÙŠÙˆÙ…ÙŠØ©</h1>
                            <span style="background:#eab308; color:#000; padding:2px 20px; border-radius:20px; font-weight:bold; font-size:12px;">ØªÙ‚Ø±ÙŠØ± Ø±Ø³Ù…ÙŠ Ù…Ø¹ØªÙ…Ø¯</span>
                        </div>
                        <div style="width:100px;"></div>
                    </div>
                    
                    <div style="background:#f8fafc; padding:20px; border-radius:12px; border:1px solid #e2e8f0; margin-bottom:30px;">
                        <p style="font-size:1.5rem; margin:0;">Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…: <span style="color:#1e3a8a; font-weight:bold;">${name}</span></p>
                        <p style="margin-top:10px; font-size:1.1rem;">ÙŠÙˆÙ…: <b>${day}</b> | ØªØ§Ø±ÙŠØ®: <b>${date}</b></p>
                    </div>

                    <table style="width:100%; border-collapse:collapse; text-align:center; border:2px solid #1e3a8a; font-size:1.2rem;">
                        <tr style="background:#1e3a8a; color:white;">
                            <th style="padding:15px; border:1px solid white;">Ø§Ù„Ø­ØµØ©</th>
                            <th style="border:1px solid white;">1</th><th style="border:1px solid white;">2</th><th style="border:1px solid white;">3</th>
                            <th style="border:1px solid white;">4</th><th style="border:1px solid white;">5</th><th style="border:1px solid white;">6</th><th style="border:1px solid white;">7</th>
                        </tr>
                        <tr style="font-weight:bold;">
                            <td style="padding:20px; border:1px solid #1e3a8a; background:#f0f9ff;">Ø­Ø§Ù„Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„</td>
                            <td style="border:1px solid #1e3a8a;">${cells[1].innerText}</td><td style="border:1px solid #1e3a8a;">${cells[2].innerText}</td>
                            <td style="border:1px solid #1e3a8a;">${cells[3].innerText}</td><td style="border:1px solid #1e3a8a;">${cells[4].innerText}</td>
                            <td style="border:1px solid #1e3a8a;">${cells[5].innerText}</td><td style="border:1px solid #1e3a8a;">${cells[6].innerText}</td>
                            <td style="border:1px solid #1e3a8a;">${cells[7].innerText}</td>
                        </tr>
                    </table>

                    <div style="margin-top:30px; border-right:8px solid #3b82f6; padding-right:15px; font-size:1.2rem;">
                        <p><b>Ø­Ø§Ù„Ø© Ø§Ù„Ø¥Ø´Ø±Ø§Ù ÙˆØ§Ù„Ù…Ù†Ø§ÙˆØ¨Ø©:</b> <span style="color:#3b82f6;">${cells[8].innerText}</span></p>
                    </div>

                    <div style="margin-top:60px; display:flex; justify-content:space-around; text-align:center;">
                        <div>
                            <p style="margin-bottom:40px;">ÙˆÙƒÙŠÙ„ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</p>
                            <b style="font-size:1.2rem;">Ø³Ù„Ø·Ø§Ù† Ø§Ù„Ø®Ø¯ÙŠØ¯ÙŠ</b><br>________________
                        </div>
                        <div>
                            <p style="margin-bottom:40px;">Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</p>
                            <b style="font-size:1.2rem;">ÙÙ‡Ø¯ Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ</b><br>________________
                        </div>
                    </div>
                </div>
            `;
            
            const win = window.open('', '', 'height=900,width=1000');
            win.document.write('<html><head><title>Ø¨Ø·Ø§Ù‚Ø© Ø£Ø¯Ø§Ø¡ - ' + name + '</title>');
            win.document.write('<style>@import url("https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap"); body{margin:0; font-family:"Tajawal", sans-serif;}</style></head><body>');
            win.document.write(cardHtml + '</body></html>');
            win.document.close();
            setTimeout(() => win.print(), 500);
        }

        buildTable();
    </script>
</body>
</html>
