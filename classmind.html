<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù†Ø¸Ø§Ù… Ø«Ø§Ù†ÙˆÙŠØ© Ø¯Ø§Ø± Ø§Ù„ØªÙˆØ­ÙŠØ¯</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&display=swap');
        body { font-family: 'Tajawal', sans-serif; background-color: #f8fafc; }
        .sticky-col { position: sticky; right: 0; background: white; z-index: 20; border-left: 2px solid #e2e8f0; }
        
        /* Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø±ØµØ¯ */
        .s-0 { background-color: #f1f5f9; color: #94a3b8; }
        .s-1 { background-color: #22c55e !important; color: white !important; }
        .s-2 { background-color: #f59e0b !important; color: white !important; }
        .s-3 { background-color: #ef4444 !important; color: white !important; }
        .s-4 { background-color: #000000 !important; color: white !important; }

        @media print {
            .no-print { display: none !important; }
            .print-only { display: block !important; }
            body { background: white; padding: 0; }
            #printWrapper { display: block !important; }
        }
        #printWrapper { display: none; }
    </style>
</head>
<body class="pb-20">

    <div class="no-print">
        <div class="bg-blue-900 text-white p-4 sticky top-0 z-50 shadow-lg">
            <div class="flex justify-between items-center max-w-5xl mx-auto">
                <div>
                    <h1 class="text-lg font-bold">Ø«Ø§Ù†ÙˆÙŠØ© Ø¯Ø§Ø± Ø§Ù„ØªÙˆØ­ÙŠØ¯</h1>
                    <p class="text-[10px] text-blue-200">Ø§Ù„ÙˆÙƒÙŠÙ„: Ø³Ù„Ø·Ø§Ù† Ø§Ù„Ø®Ø¯ÙŠØ¯ÙŠ | Ø§Ù„Ù…Ø¯ÙŠØ±: ÙÙ‡Ø¯ Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ</p>
                </div>
                <div class="flex gap-2">
                    <button onclick="window.print()" class="bg-blue-600 px-3 py-1 rounded text-xs font-bold shadow-md">
                        <i class="fas fa-print ml-1"></i> Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¹Ø§Ù…
                    </button>
                </div>
            </div>
            <div class="mt-4 flex gap-2">
                <input type="text" id="teacherSearch" onkeyup="searchFunc()" placeholder="Ø¨Ø­Ø« Ø¹Ù† Ù…Ø¹Ù„Ù…..." class="flex-1 p-2 rounded-lg text-black text-sm outline-none">
                <select id="daySelector" class="p-2 rounded-lg text-black text-sm font-bold bg-white shadow-sm">
                    <option>Ø§Ù„Ø£Ø­Ø¯</option><option>Ø§Ù„Ø§Ø«Ù†ÙŠÙ†</option><option>Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡</option><option>Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</option><option>Ø§Ù„Ø®Ù…ÙŠØ³</option>
                </select>
            </div>
        </div>

        <div class="overflow-x-auto shadow-sm">
            <table class="w-full text-right border-collapse bg-white">
                <thead class="bg-slate-800 text-white text-[10px]">
                    <tr>
                        <th class="p-3 sticky-col">Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…</th>
                        <th class="p-1 border text-center">Ø­1</th><th class="p-1 border text-center">Ø­2</th><th class="p-1 border text-center">Ø­3</th>
                        <th class="p-1 border text-center">Ø­4</th><th class="p-1 border text-center">Ø­5</th><th class="p-1 border text-center">Ø­6</th>
                        <th class="p-1 border text-center">Ø­7</th><th class="p-1 border text-center">Ø§Ù„Ù…Ù†Ø§ÙˆØ¨Ø©</th>
                        <th class="p-1 border text-center">Ø¨Ø·Ø§Ù‚Ø©</th>
                    </tr>
                </thead>
                <tbody id="teacherBody">
                    </tbody>
            </table>
        </div>

        <div class="fixed bottom-0 inset-x-0 bg-white border-t p-3 flex justify-around items-center z-50">
            <button onclick="addNewTeacher()" class="flex flex-col items-center text-emerald-600">
                <i class="fas fa-plus-circle text-xl"></i><span class="text-[10px] font-bold">Ø¥Ø¶Ø§ÙØ©</span>
            </button>
            <div class="text-center font-bold text-blue-900 text-xs" id="dateDisplay"></div>
            <button onclick="window.print()" class="flex flex-col items-center text-blue-600">
                <i class="fas fa-file-export text-xl"></i><span class="text-[10px] font-bold">ØªØµØ¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…</span>
            </button>
        </div>
    </div>

    <div id="printWrapper" class="print-only"></div>

    <script>
        // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ Ù…Ù† Ø§Ù„ØµÙˆØ±
        let teachers = [
            "Ø¹Ù„ÙŠ Ù…Ø­Ù…Ø¯ Ø§Ù„Ù‚Ø±Ù†ÙŠ", "Ø³Ø¹ÙŠØ¯ Ø§Ø­Ù…Ø¯ ÙŠØ­ÙŠÙ‰ Ø§Ù„Ø²Ù‡Ø±Ø§Ù†ÙŠ", "ÙŠØ­ÙŠÙ‰ Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… ÙŠØ­ÙŠÙ‰ Ø¯ØºØ±ÙŠØ±ÙŠ",
            "Ø§Ø­Ù…Ø¯ Ø¹Ø§Ø¨Ø¯ Ø§Ù„Ø±Ù‚ÙŠØ¨", "Ù…Ø´Ø§Ø±ÙŠ Ø®Ø§Ù„Ø¯ Ø±ÙŠØ­Ø§Ù† Ø§Ù„Ø­Ø§Ø±Ø«ÙŠ", "Ø¶ÙŠÙ Ø§Ù„Ù„Ù‡ Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø§Ù„Ù†Ù…Ø±ÙŠ",
            "Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡ ØµØ§ÙŠÙ„ Ø®Ù„ÙŠÙˆÙŠ Ø§Ù„Ø­Ø§Ø±Ø«ÙŠ", "Ø³Ø¹ÙˆØ¯ Ø¯Ø®ÙŠÙ„ Ø§Ù„Ù„Ù‡ Ù‡Ù„Ø§Ù„ Ø§Ù„Ù‚Ø±Ø´ÙŠ", "Ø³Ø¹ÙŠØ¯ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ø­ÙˆØªØ§Ù†ÙŠ",
            "Ø¹Ø§ØµÙ… Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡ Ø£Ø­Ù…Ø¯ Ø§Ù„ØºØ§Ù…Ø¯ÙŠ", "Ù†Ø§ØµØ± Ø¹ÙˆØ¶ Ù…Ø¹ÙŠØ¶ Ø§Ù„Ø«Ø¨ÙŠØªÙŠ", "Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø­Ù…Ù† Ø¹Ù„ÙŠ Ø¹Ø«Ù…Ø§Ù† Ø§Ù„Ø´Ù‡Ø±ÙŠ",
            "Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡ Ø§Ù„Ø¬Ø¹ÙŠØ¯", "Ù…Ø­Ù…Ø¯ Ù…Ù†ØµÙˆØ± Ù…Ø¬Ù…Ù…ÙŠ", "Ø±Ø§Ø¦Ø¯ Ø£Ø­Ù…Ø¯ Ø§Ù„Ø·ÙˆÙŠØ±Ù‚ÙŠ",
            "Ø¹Ù„ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù…Ø­Ø³Ù† Ø²ÙŠØ¯ Ø§Ù„Ø­Ø§Ø±Ø«ÙŠ", "Ø·Ù„Ø§Ù„ Ù…Ø­Ù…Ø¯ Ø­Ø§Ù…Ø¯ Ø§Ù„Ø³ÙÙŠØ§Ù†ÙŠ", "ÙØ§ÙŠØ² Ø¹ÙŠØ¶Ø© Ù…Ø¹ÙŠÙˆØ¶ Ø§Ù„Ø¨Ø±Ø§Ù‚",
            "Ø§Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø§Ù„Ø«Ù…Ø§Ù„ÙŠ", "ÙÙˆØ§Ø² Ù…Ø·Ù„Ù‚ Ù…Ø¹ÙŠÙˆØ¶ Ø§Ù„Ø­ØµÙŠÙ†ÙŠ", "Ø¨Ø¯Ø± Ø³Ø¹ÙŠØ¯ Ø¹ÙˆØ¶ Ø§Ù„Ø­Ø§Ø±Ø«ÙŠ",
            "ÙÙŠØµÙ„ Ø¹Ù„ÙŠ Ù…ØºØ±Ù… Ø§Ù„Ø´Ù‡Ø±ÙŠ", "Ù…Ø´Ø¹Ù„ ÙØ±Ø¬ Ø¬Ø§Ø± Ø§Ù„Ù†Ø¨ÙŠ Ø§Ù„Ø¨Ø±Ø¯ÙŠ", "Ø´Ø§ÙƒØ± Ø³Ø¹Ø¯ Ø§Ù„Ø²Ø§ÙŠØ¯ÙŠ",
            "Ø£Ø­Ù…Ø¯ Ø­Ø³Ù† Ø¹Ù„ÙŠ Ø§Ù„Ø²Ù‡Ø±Ø§Ù†ÙŠ", "ØªØ±ÙƒÙŠ Ø¹Ø§Ù„ÙŠ Ø§Ù„Ù‚ØµÙŠÙˆÙŠ", "Ù†Ø§ÙŠÙ Ù…Ø¹ÙŠÙˆØ¶ Ø±Ø¯Ù‡ Ø§Ù„Ø«Ø¨ÙŠØªÙŠ",
            "Ø³Ø§Ù…ÙŠ Ø³Ø¹ÙŠØ¯ Ø§Ù„Ø¹Ù…Ø±ÙŠ", "Ù‡Ø§Ù†ÙŠ Ø®Ù„Ù Ø¬Ø¨Ø±Ø§Ù† Ø§Ù„Ù‚Ø±Ø´ÙŠ", "Ø¹ÙˆØ§Ø¶ Ø¹Ø¨Ø¯Ø§Ù„Ù‡Ø§Ø¯ÙŠ Ø§Ù„Ø«Ø¨ÙŠØªÙŠ",
            "Ø³Ù„Ø·Ø§Ù† Ù‡Ù„Ø§Ù„ Ø§Ù„Ø«Ø¨ÙŠØªÙŠ", "Ù…Ø­Ù…Ø¯ Ø³Ø¹Ø¯ Ø¹Ø¨Ø¯Ø§Ù„ØµÙ…Ø¯ Ø§Ù„ÙˆÙ‚Ø¯Ø§Ù†ÙŠ"
        ];

        const pStates = [{l: "-", c: "s-0"}, {l: "âœ“", c: "s-1"}, {l: "10Ø¯", c: "s-2"}, {l: "+10", c: "s-3"}, {l: "X", c: "s-4"}];
        const dStates = [{l: "ØºÙŠØ± Ù…ÙƒÙ„Ù Ø§Ù„ÙŠÙˆÙ…", c: "bg-gray-100"}, {l: "Ù…Ù†Ø§ÙˆØ¨ âœ…", c: "bg-green-600 text-white font-bold"}, {l: "Ù…Ø´Ø±Ù ğŸ›¡ï¸", c: "bg-blue-600 text-white font-bold"}];

        function initApp() {
            const tableBody = document.getElementById('teacherBody');
            tableBody.innerHTML = '';
            teachers.forEach((name) => {
                let row = `
                <tr class="border-b">
                    <td class="p-3 sticky-col font-bold text-[11px] whitespace-nowrap bg-white border-l shadow-sm">${name}</td>
                    ${Array(7).fill().map(() => `<td onclick="cycleP(this)" class="p-1 border text-center cursor-pointer s-0 font-bold text-[10px] w-10 h-12" data-s="0">-</td>`).join('')}
                    <td class="p-1 border text-center">
                        <button onclick="cycleD(this)" data-d="0" class="text-[9px] w-full py-2 rounded bg-gray-100">ØºÙŠØ± Ù…ÙƒÙ„Ù</button>
                    </td>
                    <td class="p-1 border text-center">
                        <button onclick="triggerCardPrint('${name}', this)" class="text-blue-500"><i class="fas fa-id-card text-lg"></i></button>
                    </td>
                </tr>`;
                tableBody.innerHTML += row;
            });
            document.getElementById('dateDisplay').innerText = new Date().toLocaleDateString('ar-SA');
        }

        function cycleP(el) {
            let s = (parseInt(el.dataset.s) + 1) % pStates.length;
            el.dataset.s = s;
            el.innerText = pStates[s].l;
            el.className = `p-1 border text-center cursor-pointer font-bold text-[10px] w-10 h-12 ${pStates[s].c}`;
        }

        function cycleD(btn) {
            let d = (parseInt(btn.dataset.d) + 1) % dStates.length;
            btn.dataset.d = d;
            btn.innerText = dStates[d].l;
            btn.className = `text-[9px] w-full py-2 rounded ${dStates[d].c}`;
        }

        function searchFunc() {
            let q = document.getElementById('teacherSearch').value;
            let rows = document.querySelectorAll('#teacherBody tr');
            rows.forEach(r => r.style.display = r.innerText.includes(q) ? '' : 'none');
        }

        async function addNewTeacher() {
            const { value: name } = await Swal.fire({ title: 'Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯', input: 'text', confirmButtonColor: '#1e3a8a' });
            if (name) { teachers.unshift(name); initApp(); }
        }

        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„ÙØ±Ø¯ÙŠØ© Ù„Ù„Ø·Ø¨Ø§Ø¹Ø©
        function triggerCardPrint(name, btn) {
            const row = btn.closest('tr');
            const cells = row.querySelectorAll('td');
            const day = document.getElementById('daySelector').value;
            const date = document.getElementById('dateDisplay').innerText;
            const printWrapper = document.getElementById('printWrapper');

            printWrapper.innerHTML = `
                <div style="direction:rtl; padding:40px; border:15px double #1e3a8a; font-family:'Tajawal', sans-serif; background:white;">
                    <div style="display:flex; justify-content:space-between; border-bottom:4px solid #1e3a8a; padding-bottom:15px; margin-bottom:20px;">
                        <div style="font-size:14px; font-weight:bold;">Ø«Ø§Ù†ÙˆÙŠØ© Ø¯Ø§Ø± Ø§Ù„ØªÙˆØ­ÙŠØ¯</div>
                        <div style="text-align:center;">
                            <h1 style="margin:0; color:#1e3a8a; font-size:24px;">Ø¨Ø·Ø§Ù‚Ø© Ø£Ø¯Ø§Ø¡ Ù…Ø¹Ù„Ù… ÙŠÙˆÙ…ÙŠØ©</h1>
                            <span style="background:#f59e0b; color:black; padding:2px 15px; border-radius:15px; font-size:12px; font-weight:bold;">ØªÙ‚Ø±ÙŠØ± Ù…Ø¹ØªÙ…Ø¯</span>
                        </div>
                        <div style="width:100px;"></div>
                    </div>
                    <div style="background:#f1f5f9; padding:20px; border-radius:10px; margin-bottom:20px;">
                        <p style="font-size:1.5rem; margin:0;">Ø§Ù„Ù…Ø¹Ù„Ù…: <b style="color:#1e3a8a;">${name}</b></p>
                        <p style="margin-top:10px;">Ø§Ù„ÙŠÙˆÙ…: <b>${day}</b> | Ø§Ù„ØªØ§Ø±ÙŠØ®: <b>${date}</b></p>
                    </div>
                    <table style="width:100%; border-collapse:collapse; text-align:center; border:2px solid #1e3a8a;">
                        <tr style="background:#1e3a8a; color:white;">
                            <th style="padding:15px; border:1px solid white;">Ø§Ù„Ø­ØµØ©</th>
                            <th style="border:1px solid white;">1</th><th style="border:1px solid white;">2</th><th style="border:1px solid white;">3</th>
                            <th style="border:1px solid white;">4</th><th style="border:1px solid white;">5</th><th style="border:1px solid white;">6</th><th style="border:1px solid white;">7</th>
                        </tr>
                        <tr style="font-weight:bold; font-size:1.2rem;">
                            <td style="padding:20px; border:1px solid #1e3a8a; background:#e0e7ff;">Ø§Ù„Ø­Ø§Ù„Ø©</td>
                            <td style="border:1px solid #1e3a8a;">${cells[1].innerText}</td><td style="border:1px solid #1e3a8a;">${cells[2].innerText}</td>
                            <td style="border:1px solid #1e3a8a;">${cells[3].innerText}</td><td style="border:1px solid #1e3a8a;">${cells[4].innerText}</td>
                            <td style="border:1px solid #1e3a8a;">${cells[5].innerText}</td><td style="border:1px solid #1e3a8a;">${cells[6].innerText}</td>
                            <td style="border:1px solid #1e3a8a;">${cells[7].innerText}</td>
                        </tr>
                    </table>
                    <p style="margin-top:20px; border-right:5px solid #1e3a8a; padding-right:10px;"><b>Ø§Ù„Ø¥Ø´Ø±Ø§Ù ÙˆØ§Ù„Ù…Ù†Ø§ÙˆØ¨Ø©:</b> ${cells[8].innerText}</p>
                    <div style="margin-top:60px; display:flex; justify-content:space-around; text-align:center; font-weight:bold;">
                        <div>ÙˆÙƒÙŠÙ„ Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ù„Ù„Ø´Ø¤ÙˆÙ† Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©<br>Ø³Ù„Ø·Ø§Ù† Ø§Ù„Ø®Ø¯ÙŠØ¯ÙŠ<br>________________</div>
                        <div>Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©<br>ÙÙ‡Ø¯ Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ<br>________________</div>
                    </div>
                </div>
            `;
            window.print();
        }

        // Ø¹Ù†Ø¯ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø¹Ø§Ù…
        window.onbeforeprint = () => {
            if(document.getElementById('printWrapper').innerHTML === "") {
                const wrap = document.getElementById('printWrapper');
                const day = document.getElementById('daySelector').value;
                const date = document.getElementById('dateDisplay').innerText;
                let h = `<h2 style="text-align:center;">ÙƒØ´Ù Ø±ØµØ¯ Ø­ØµØµ ÙŠÙˆÙ…ÙŠ - Ø«Ø§Ù†ÙˆÙŠØ© Ø¯Ø§Ø± Ø§Ù„ØªÙˆØ­ÙŠØ¯</h2><p style="text-align:center;">ÙŠÙˆÙ… ${day} Ø§Ù„Ù…ÙˆØ§ÙÙ‚ ${date}</p><table border="1" style="width:100%; border-collapse:collapse; text-align:center;"><tr style="background:#eee;"><th>Ø§Ù„Ù…Ø¹Ù„Ù…</th><th>Ø­1</th><th>Ø­2</th><th>Ø­3</th><th>Ø­4</th><th>Ø­5</th><th>Ø­6</th><th>Ø­7</th><th>Ø§Ù„Ù…Ù†Ø§ÙˆØ¨Ø©</th></tr>`;
                document.querySelectorAll('#teacherBody tr').forEach(r => {
                    let c = r.querySelectorAll('td');
                    h += `<tr><td style="text-align:right; padding:5px;">${c[0].innerText}</td><td>${c[1].innerText}</td><td>${c[2].innerText}</td><td>${c[3].innerText}</td><td>${c[4].innerText}</td><td>${c[5].innerText}</td><td>${c[6].innerText}</td><td>${c[7].innerText}</td><td>${c[8].innerText}</td></tr>`;
                });
                wrap.innerHTML = h + `</table><div style="display:flex; justify-content:space-around; margin-top:40px; text-align:center;"><div>ÙˆÙƒÙŠÙ„ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©<br>Ø³Ù„Ø·Ø§Ù† Ø§Ù„Ø®Ø¯ÙŠØ¯ÙŠ</div><div>Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©<br>ÙÙ‡Ø¯ Ø§Ù„Ù‚Ø­Ø·Ø§Ù†ÙŠ</div></div>`;
            }
        };

        window.onafterprint = () => { document.getElementById('printWrapper').innerHTML = ""; };

        initApp();
    </script>
</body>
</html>
