<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ุชุฎุทูุท ุดุงุบูู ุงููุธุงุฆู ุงูุชุนููููุฉ</title>
  <!-- ุฃูู ููุทุฉ: ุถุจุท ุงูู viewport ูุชุชูุงุณุจ ูุน ูู ุงูุดุงุดุงุช -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#158078">
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@600;700&display=swap" rel="stylesheet">
  <style>
    body {background:#f5f6f7;font-family:'Cairo',Tahoma,Arial,sans-serif;}
    header {background:#158078;color:#fff;padding:32px 0 18px 0;text-align:center;border-radius:0 0 30px 30px;}
    h1 {font-size:2.3em;margin-bottom:8px;font-weight:700;}
    .container {max-width:99vw; width:99%; margin:0 auto; padding:10px 2vw 50px 2vw;}
    .panel {background:#e7e5db;border-radius:22px;box-shadow:0 2px 16px 0 #0b595247;margin-bottom:26px;padding:30px 25px 18px 25px;}
    h2 {color:#158078;font-weight:bold;margin-bottom:14px;font-size:1.24em;border-right:8px solid #158078;padding-right:12px;display:inline-block;border-radius:0 17px 17px 0;}
    label {font-size:1.06em;margin-bottom:5px;color:#158078;font-weight:bold;}
    input,select,textarea {width:100%;padding:9px 10px;border-radius:8px;border:1.5px solid #d7ccb6;background:#f5f6f7;color:#183c3b;font-size:1.01em;margin-bottom:13px;}
    input:focus,select:focus,textarea:focus {outline:none;border:1.5px solid #158078;}
    textarea {resize:vertical;}
    .btn {background:linear-gradient(90deg,#158078,#1eb09b 70%);color:#fff;border:none;border-radius:9px;padding:10px 32px;font-size:1.07em;cursor:pointer;margin:4px 7px 8px 0;font-weight:bold;box-shadow:0 1px 4px #0002;}
    .btn:hover {background:linear-gradient(90deg,#1eb09b 30%,#158078 100%);}
    table {width:100%;border-collapse:collapse;margin-bottom:10px;background:#f5f6f7;color:#183c3b;font-size:1.01em;border-radius:14px;overflow:hidden;box-shadow:0 0.5px 6px #15807822; display: block; overflow-x: auto;}
    th,td {border:1px dashed #c6a96d;padding:8px 7px;text-align:center;}
    th {background:#158078;color:#fff;font-weight:bold;}
    .footer-signature {color:#9e7e45;background:#e5e1d4;border-radius:0 0 18px 18px;font-size:1.13em;text-align:center;padding:19px 0 13px 0;margin-top:38px;font-weight:bold;border-top:2px solid #c6a96d44;}
    .main-btns {text-align:center;margin-bottom:40px;}
    /* responsive styles */
    @media (max-width: 600px) {
      h1 {font-size:1.4em;}
      h2 {font-size:1em;}
      .panel {padding:15px 7px 10px 7px;}
      .container {padding:5px 0 30px 0;}
      table, th, td {font-size:0.97em;}
      input, select, textarea {font-size:0.97em;}
      .main-btns button, .btn {padding:7px 15px;font-size:1em;}
    }
  </style>
</head>
<body>
  <header>
    <h1>ุชุฎุทูุท ุดุงุบูู ุงููุธุงุฆู ุงูุชุนููููุฉ - ุงููุฑุญูุฉ ุงูุซุงูููุฉ</h1>
    <div class="footer-signature">ุงูุฅุฏุงุฑุฉ ุงูุนุงูุฉ ูุชุชุนููู ุจุงูุทุงุฆู - ุซุงูููุฉ ุฏุงุฑ ุงูุชูุญูุฏ </div>
  </header>
  <div class="container">
    <div class="main-btns">
      <button class="btn" id="exportHtmlBtn">ุชูุฑูุฑ ุดุงูู</button>
      <button class="btn" id="resetAllBtn">๐๏ธ ูุณุญ ุงูุฌููุน</button>
    </div>
    <div class="panel">
      <h2>ุงููุงุฏุฑ ุงูุชุนูููู</h2>
      <form id="eduForm">
        <label>ุงุณู ุงูููุธู:</label>
        <input type="text" id="eduName" required autocomplete="off">
        <label>ุงูุฑุชุจุฉ/ุงููุตู:</label>
        <select id="eduJob" required>
          <option value="">-- ุงุฎุชุฑ --</option>
          <option>ูุนูู ููุงุฑุณ</option>
          <option>ูุนูู ูุชูุฏู</option>
          <option>ูุนูู ุฎุจูุฑ</option>
          <option>ูุฏูุฑ ูุฏุฑุณุฉ</option>
          <option>ูููู ูุฏุฑุณุฉ</option>
          <option>ููุฌู ุทูุงุจู</option>
          <option>ุฑุงุฆุฏ ูุดุงุท</option>
          <option>ููุฌู ุตุญู</option>
          <option>ูุญุถุฑ ูุฎุชุจุฑ</option>
        </select>
        <div id="eduMaterialWrap">
          <label>ุงููุงุฏุฉ (ูููุนูู ููุท):</label>
          <select id="eduMaterial"></select>
        </div>
        <div id="eduSpecWrap">
          <label>ุงูุชุฎุตุต ุงูุฑุฆูุณู:</label>
          <select id="eduSpec">
            <option value="">-- ุงุฎุชุฑ --</option>
            <option>ุงูุฏุฑุงุณุงุช ุงูุฅุณูุงููุฉ</option>
            <option>ุงูููุงูุงุช ุงููุบููุฉ</option>
            <option>ุงูุฅูุฌููุฒูุฉ</option>
            <option>ุงูุฑูุงุถูุงุช</option>
            <option>ุงูุชูููุฉ ุงูุฑูููุฉ</option>
            <option>ุงูุฃุญูุงุก ูุนููู ุงูุจูุฆุฉ ูุงููุถุงุก</option>
            <option>ุงูุชูููุฑ ูุงูููุงุฑุงุช ูุงูุญูุงุฉ</option>
            <option>ุงููุนุฑูุฉ ุงููุงููุฉ/ุงูููููุฉ</option>
            <option>ุงูุชุฑุจูุฉ ุงูุตุญูุฉ ูุงูููุงูุฉ</option>
            <option>ุงูุฏุฑุงุณุงุช ุงูุงุฌุชูุงุนูุฉ</option>
            <option>ุงูููููุงุก</option>
            <option>ุงูููุฒูุงุก</option>
            <option>ุงููููู</option>
            <option>ุงูุจุญุซ ููุตุงุฏุฑ ุงููุนูููุงุช</option>
            <option>ูุฌุงู ุงุฎุชูุงุฑู</option>
            <option>ุงูุฏุฑุงุณุงุช ุงูุฃุฏุจูุฉ</option>
          </select>
        </div>
        <div id="eduPeriodsWrap">
          <label>ุนุฏุฏ ุงููุตูู:</label>
          <input type="number" id="eduClasses" min="0" value="0">
          <label>ุนุฏุฏ ุงูุญุตุต (ูุญุณุจ ุชููุงุฆููุง):</label>
          <input type="number" id="eduPeriods" min="0" value="0" readonly>
        </div>
        <label>ููุงู ุฃุฎุฑู:</label>
        <textarea id="eduTasks" rows="2"></textarea>
        <div id="eduReleaseWrap" style="display:none">
          <label>ุญุงูุฉ ุงูุชูุฑุบ:</label>
          <select id="eduRelease">
            <option value="">-- ุงุฎุชุฑ --</option>
            <option>ููุฑุบ ููููุง</option>
            <option>ููุฑุบ ุฌุฒุฆููุง</option>
          </select>
        </div>
        <button class="btn" type="submit">ุฅุถุงูุฉ</button>
      </form>
      <div id="eduTableContainer"></div>
    </div>
    <div class="footer-signature">
      ููุฑุฉ ูุชุตููู ูุญูุฏ ูุฌููู โ ุฌููุน ุงูุญููู ูุญููุธุฉ ยฉ 2025
    </div>
  </div>
<script>
/* ููุณ ุงูุณูุฑูุจุช ุงููุฏูู - ุจุฏูู ุชุนุฏูู */
const materials = [
  {name:"ุงููุฑุขู ุงููุฑูู ูุชูุณูุฑู", periods:5},{name:"ุงูููุงูุงุช ุงููุบููุฉ 1 (1-1)",periods:5},{name:"ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ 1 (1-1)",periods:5},
  {name:"ุงูุฑูุงุถูุงุช 1 (1-1)",periods:5},{name:"ุงูุชูููุฉ ุงูุฑูููุฉ 1 (1-1)",periods:3},{name:"ุงูุฃุญูุงุก (1)",periods:5},{name:"ุงูุชูููุฑ ุงููุงูุฏ",periods:4},
  {name:"ุนูู ุงูุจูุฆุฉ",periods:3},{name:"ุงูููุงูุงุช ุงููุบููุฉ 1 (2-1)",periods:5},{name:"ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ 1 (2-1)",periods:5},{name:"ุงูุฑูุงุถูุงุช 1 (2-1)",periods:5},
  {name:"ุงูุชูููุฉ ุงูุฑูููุฉ 1 (2-1)",periods:3},{name:"ุงูููุฒูุงุก (1)",periods:5},{name:"ุงูุชุฑุจูุฉ ุงูููููุฉ",periods:3},{name:"ุงูุชุฑุจูุฉ ุงูุตุญูุฉ ูุงูุจุฏููุฉ 1 (1-1)",periods:3},
  {name:"ุงููุนุฑูุฉ ุงููุงููุฉ",periods:3},{name:"ุงูุญุฏูุซ (1)",periods:3},{name:"ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ 1 (3-1)",periods:5},{name:"ุงูุฑูุงุถูุงุช 1 (3-1)",periods:5},
  {name:"ุงูุชูููุฉ ุงูุฑูููุฉ 1 (3-1)",periods:3},{name:"ุงูููููุงุก (1)",periods:5},{name:"ุงูุฏุฑุงุณุงุช ุงูุงุฌุชูุงุนูุฉ",periods:3},{name:"ุงูุชุฑุจูุฉ ุงูุตุญูุฉ ูุงูุจุฏููุฉ 1 (2-1)",periods:3},
  {name:"ุงูุชูุญูุฏ (1)",periods:3},{name:"ุงููููู",periods:3},{name:"ุงูููุงูุฉ ูุงูุซูุงูุฉ ุงูุตุญูุฉ",periods:5},{name:"ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ 2 (1-2)",periods:5},
  {name:"ุงูุฑูุงุถูุงุช 2 (1-2)",periods:5},{name:"ุงูููููุงุก 2 (1-2)",periods:5},{name:"ุงูุฃุญูุงุก 2 (1-2)",periods:4},{name:"ุงูููุงูุงุช ุงููุบููุฉ 2 (1-2)",periods:3},
  {name:"ุงูุชูููุฉ ุงูุฑูููุฉ 2 (1-2)",periods:3},{name:"ุงูุชุงุฑูุฎ",periods:5},{name:"ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ 2 (2-2)",periods:5},{name:"ุงูุฑูุงุถูุงุช 2 (2-2)",periods:5},
  {name:"ุงูููููุงุก 2 (2-2)",periods:5},{name:"ุงูุฃุญูุงุก 2 (2-2)",periods:4},{name:"ุงูููุงูุงุช ุงููุบููุฉ 2 (2-2)",periods:3},{name:"ุงูุชูููุฉ ุงูุฑูููุฉ 2 (2-2)",periods:3},
  {name:"ุงูููุฒูุงุก (2)",periods:5},{name:"ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ 2 (3-2)",periods:5},{name:"ุงูุฑูุงุถูุงุช 2 (3-2)",periods:5},{name:"ุงูููููุงุก 2 (3-2)",periods:5},
  {name:"ุงูุฃุญูุงุก 2 (3-2)",periods:4},{name:"ุงูุจุญุซ ููุตุงุฏุฑ ุงููุนูููุงุช",periods:3},{name:"ุงูุฌุบุฑุงููุง",periods:3},{name:"ุงูุชูููุฉ ุงูุฑูููุฉ (3)",periods:3},
  {name:"ุงูููููุงุก (3)",periods:5},{name:"ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ 3 (1-3)",periods:4},{name:"ุงูุฑูุงุถูุงุช 3 (1-3)",periods:4},{name:"ุงูููุฒูุงุก 3 (1-3)",periods:5},
  {name:"ูุฌุงู ุงุฎุชูุงุฑู",periods:4},{name:"ุงูููู (1)",periods:3},{name:"ุงูููุงุฑุงุช ุงูุญูุงุชูุฉ",periods:3},{name:"ุงูููุงุทูุฉ ุงูุฑูููุฉ",periods:3},
  {name:"ุนููู ุงูุฃุฑุถ ูุงููุถุงุก (1-1)",periods:4},{name:"ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ 3 (2-3)",periods:4},{name:"ุงูุฑูุงุถูุงุช 3 (2-3)",periods:4},
  {name:"ุงูููุฒูุงุก 3 (2-3)",periods:5},{name:"ุงูุฏุฑุงุณุงุช ุงูุฃุฏุจูุฉ",periods:3},{name:"ุงูุฏุฑุงุณุงุช ุงูููุณูุฉ ูุงูุงุฌุชูุงุนูุฉ",periods:3},{name:"ุงูุชุฑุจูุฉ ุงูุตุญูุฉ ูุงูุจุฏููุฉ (2)",periods:4},
  {name:"ุนููู ุงูุฃุฑุถ ูุงููุถุงุก (2-1)",periods:4},{name:"ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ 3 (3-3)",periods:4},{name:"ุงูุฑูุงุถูุงุช 3 (3-3)",periods:4},{name:"ุงูููุฒูุงุก 3 (3-3)",periods:5}
];
const eduRanks = { "ูุนูู ููุงุฑุณ":24, "ูุนูู ูุชูุฏู":22, "ูุนูู ุฎุจูุฑ":18 };
let educational = JSON.parse(localStorage.getItem('eduList')||"[]");
function fillMaterialList(){
  let msel=document.getElementById('eduMaterial');
  msel.innerHTML='<option value="">-- ุงุฎุชุฑ --</option>';
  materials.forEach(m=>msel.innerHTML+=`<option value="${m.name}" data-p="${m.periods}">${m.name}</option>`);
}
document.getElementById('eduJob').onchange = function(){
  let job = this.value;
  let isTeacher = ["ูุนูู ููุงุฑุณ","ูุนูู ูุชูุฏู","ูุนูู ุฎุจูุฑ"].includes(job);
  document.getElementById('eduMaterialWrap').style.display = isTeacher?"block":"none";
  document.getElementById('eduSpecWrap').style.display = isTeacher?"block":"none";
  document.getElementById('eduPeriodsWrap').style.display = isTeacher?"block":"none";
  document.getElementById('eduReleaseWrap').style.display = (!isTeacher && job!=="")?"block":"none";
  if(isTeacher){ fillMaterialList(); }
  else{ document.getElementById('eduMaterial').innerHTML = ''; }
  document.getElementById('eduClasses').value=0;
  document.getElementById('eduPeriods').value=0;
};
fillMaterialList();
document.getElementById('eduMaterial').onchange=function(){
  let m=materials.find(x=>x.name===this.value);
  document.getElementById('eduPeriods').value=0;
  document.getElementById('eduClasses').value=0;
  if(m){
    document.getElementById('eduClasses').oninput=function(){
      let v=parseInt(this.value)||0;
      document.getElementById('eduPeriods').value=v*m.periods;
    };
  }
};
document.getElementById('eduForm').onsubmit=function(e){
  e.preventDefault();
  let name = document.getElementById('eduName').value.trim();
  let job = document.getElementById('eduJob').value;
  let material = document.getElementById('eduMaterial').value;
  let spec = document.getElementById('eduSpec').value;
  let classes = parseInt(document.getElementById('eduClasses').value)||0;
  let periods = parseInt(document.getElementById('eduPeriods').value)||0;
  let tasks = document.getElementById('eduTasks').value.trim();
  let release = "";
  if(["ูุฏูุฑ ูุฏุฑุณุฉ","ูููู ูุฏุฑุณุฉ","ููุฌู ุทูุงุจู","ุฑุงุฆุฏ ูุดุงุท","ููุฌู ุตุญู","ูุญุถุฑ ูุฎุชุจุฑ"].includes(job)){
    release = document.getElementById('eduRelease').value;
  }
  if(name==="")return;
  if(["ูุนูู ููุงุฑุณ","ูุนูู ูุชูุฏู","ูุนูู ุฎุจูุฑ"].includes(job)){
    if(material===""||spec===""||isNaN(periods)){alert("ูุฌุจ ุงุฎุชูุงุฑ ูุงุฏุฉ ูุชุฎุตุต ุชุฌููุนู ูุนุฏุฏ ุญุตุต ูููุนูู");return;}
    educational.push({name,job,material,spec,classes,periods,tasks,release});
  }else{
    educational.push({name,job,material:"-",spec:"-",classes:"-",periods:"-",tasks,release});
  }
  this.reset();document.getElementById('eduReleaseWrap').style.display="none";
  renderTableEdu(); saveAllData();
};
document.getElementById('resetAllBtn').onclick=function(){
  if(confirm("ุชุฃููุฏ ูุณุญ ุฌููุน ุงูุจูุงูุงุชุ")){
    educational=[];
    saveAllData();renderTableEdu();
  }
};
function saveAllData(){
  localStorage.setItem('eduList',JSON.stringify(educational));
}
function renderTableEdu(){
  let h="";
  if(!educational.length){h='<p style="text-align:center;color:#ccc">ูุง ููุฌุฏ ููุธููู.</p>';}
  else{
    h='<table><thead><tr><th>ู</th><th>ุงูุงุณู</th><th>ุงูุฑุชุจุฉ/ุงููุตู</th><th>ุงููุงุฏุฉ</th><th>ุงูุชุฎุตุต ุงูุฑุฆูุณู</th><th>ูุตูู</th><th>ุงูุญุตุต</th><th>ููุงู ุฃุฎุฑู</th><th>ุงูุชูุฑุบ</th><th>ุญุฐู</th></tr></thead><tbody>';
    educational.forEach((emp,i)=>{
      h+=`<tr>
        <td>${i+1}</td>
        <td>${emp.name}</td>
        <td>${emp.job}</td>
        <td>${emp.material||"-"}</td>
        <td>${emp.spec||"-"}</td>
        <td>${emp.classes||"-"}</td>
        <td>${emp.periods||"-"}</td>
        <td>${emp.tasks||"-"}</td>
        <td>${emp.release||"-"}</td>
        <td><button class="btn" style="padding:2px 14px" onclick="deleteEmp(${i})">ุญุฐู</button></td>
      </tr>`;
    });
    h+='</tbody></table>';
  }
  document.getElementById('eduTableContainer').innerHTML = h;
}
window.deleteEmp = function(idx){
  educational.splice(idx,1);renderTableEdu();saveAllData();
};
renderTableEdu();

document.getElementById('exportHtmlBtn').onclick = function(){
  let specs = [
    "ุงูุฏุฑุงุณุงุช ุงูุฅุณูุงููุฉ","ุงูููุงูุงุช ุงููุบููุฉ","ุงูุฅูุฌููุฒูุฉ","ุงูุฑูุงุถูุงุช","ุงูุชูููุฉ ุงูุฑูููุฉ","ุงูุฃุญูุงุก ูุนููู ุงูุจูุฆุฉ ูุงููุถุงุก",
    "ุงูุชูููุฑ ูุงูููุงุฑุงุช ูุงูุญูุงุฉ","ุงููุนุฑูุฉ ุงููุงููุฉ/ุงูููููุฉ","ุงูุชุฑุจูุฉ ุงูุตุญูุฉ ูุงูููุงูุฉ","ุงูุฏุฑุงุณุงุช ุงูุงุฌุชูุงุนูุฉ","ุงูููููุงุก",
    "ุงูููุฒูุงุก","ุงููููู","ุงูุจุญุซ ููุตุงุฏุฑ ุงููุนูููุงุช","ูุฌุงู ุงุฎุชูุงุฑู","ุงูุฏุฑุงุณุงุช ุงูุฃุฏุจูุฉ"
  ];
  let reportRows = [];
  specs.forEach(spec=>{
    let teachers = educational.filter(e=>
      ["ูุนูู ููุงุฑุณ","ูุนูู ูุชูุฏู","ูุนูู ุฎุจูุฑ"].includes(e.job) && e.spec==spec
    );
    let totalPeriods = teachers.reduce((s,x)=>s+(parseInt(x.periods)||0),0);
    let khabeer = teachers.filter(x=>x.job=="ูุนูู ุฎุจูุฑ").length;
    let motakadem = teachers.filter(x=>x.job=="ูุนูู ูุชูุฏู").length;
    let mmaris = teachers.filter(x=>x.job=="ูุนูู ููุงุฑุณ").length;
    let pool = [];
    for(let i=0;i<khabeer;i++) pool.push(18);
    for(let i=0;i<motakadem;i++) pool.push(22);
    for(let i=0;i<mmaris;i++) pool.push(24);
    pool.sort((a,b)=>a-b);
    let remain = totalPeriods, used = 0;
    for(let i=0;i<pool.length;i++){
      if(remain<=0) break;
      let take = Math.min(pool[i], remain);
      remain -= take;
      used++;
    }
    let surplus = 0, resultTxt = "", needed = 0;
    if(remain>0){
      needed = Math.ceil(remain/24);
      resultTxt = `<b style="color:#bf4f4f">ุงุญุชูุงุฌ ${needed} ูุนูู ููุงุฑุณ (${remain} ุญุตุฉ ุบูุฑ ูุบุทุงุฉ)</b>`;
    } else if(totalPeriods>0 && pool.length > 0 && used<pool.length){
      let extra = pool.length-used;
      let extraMmaris = Math.min(extra, mmaris);
      resultTxt = `<b style="color:#32bf32">ููุฑ ${extraMmaris} ูุนูู ููุงุฑุณ</b>`;
      let left = extra - extraMmaris;
      if(left > 0) resultTxt += ` + ููุฑ ${left} ูู ุงูุฑุชุจ ุงูุฃุนูู`;
    } else {
      resultTxt = `<b style="color:#158078">ุชุบุทูุฉ ุนุงุฏูุฉ</b>`;
    }
    reportRows.push(`<tr><td>${spec}</td><td>${totalPeriods}</td><td>${teachers.length}</td><td>${resultTxt}</td></tr>`);
  });
  let tbl1 = document.getElementById('eduTableContainer').innerHTML;
  let html = `
  <!DOCTYPE html>
  <html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8">
    <title>ุชูุฑูุฑ ุชุฎุทูุท ุดุงุบูู ุงููุธุงุฆู ุงูุชุนููููุฉ</title>
    <style>
      body {background:#f5f6f7;font-family:'Cairo',Tahoma,Arial,sans-serif;color:#183c3b;}
      .container {max-width:1140px;margin:0 auto;padding:0 10px 25px 10px;}
      .panel {background:#e7e5db;border-radius:22px;box-shadow:0 2px 16px 0 #0b595247;margin-bottom:26px;padding:30px 25px 18px 25px;}
      h2 {color:#158078;font-weight:bold;margin-bottom:14px;font-size:1.38em;border-right:8px solid #158078;padding-right:12px;background:linear-gradient(90deg,#f5f6f7 80%,#158078 100%);display:inline-block;border-radius:0 17px 17px 0;}
      table {width:100%;border-collapse:collapse;margin-bottom:10px;background:#f5f6f7;color:#183c3b;font-size:1.01em;border-radius:14px;overflow:hidden;box-shadow:0 0.5px 6px #15807822;}
      th,td {border:1px dashed #c6a96d;padding:8px 7px;text-align:center;}
      th {background:#158078;color:#fff;font-weight:bold;}
      .footer-signature {color:#9e7e45;background:#e5e1d4;border-radius:0 0 18px 18px;font-size:1.13em;text-align:center;padding:19px 0 13px 0;margin-top:38px;font-weight:bold;border-top:2px solid #c6a96d44;}
      @media print {button#printBtn {display:none !important;}}
    </style>
  </head>
  <body>
    <button id="printBtn" onclick="window.print()" style="position:fixed;top:20px;left:30px;z-index:999;background:#158078;color:#fff;border:none;border-radius:9px;padding:10px 30px;font-size:1.05em;box-shadow:0 1px 4px #0002;font-weight:bold;cursor:pointer;">
      ๐จ๏ธ ุทุจุงุนุฉ ุงูุชูุฑูุฑ
    </button>
    <header>
      <h1>ุชูุฑูุฑ ุดุงุบูู ุงููุธุงุฆู ุงูุชุนููููุฉ</h1>
    </header>
    <div class="container">
      <div class="panel">
        <h2>ุงููุงุฏุฑ ุงูุชุนูููู</h2>
        ${tbl1}
      </div>
      <div class="panel">
        <h2>ุชูุฑูุฑ ุงูุชุฎุตุตุงุช ุงูุฑุฆูุณูุฉ</h2>
        <table>
          <tr><th>ุงูุชุฎุตุต ุงูุฑุฆูุณู</th><th>ุฅุฌูุงูู ุงูุญุตุต</th><th>ุนุฏุฏ ุงููุนูููู</th><th>ุงููุชูุฌุฉ</th></tr>
          ${reportRows.join('')}
        </table>
      </div>
      <div class="footer-signature">
        ููุฑุฉ ูุชุตููู ูุญูุฏ ูุฌููู โ ุฌููุน ุงูุญููู ูุญููุธุฉ ยฉ 2025
      </div>
    </div>
  </body>
  </html>`;
  let newWin = window.open("", "", "width=1200,height=800,scrollbars=yes");
  newWin.document.open(); newWin.document.write(html); newWin.document.close();
};
</script>
<script>
// ุชุณุฌูู ุงูุฎุฏูุฉ ูู PWA
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("sw.js")
    .then(reg => console.log("Service Worker Registered", reg))
    .catch(err => console.error("Service Worker Error", err));
}
</script>
</body>
</html>
