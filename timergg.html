<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ุงุฏุงุฉ ุงูููุช ุงููุนูู - ุซุงูููุฉ ุฏุงุฑ ุงูุชูุญูุฏ</title>
    <!-- Tailwind CDN (ูููุฑ ูุงุฆุฏุฉ ุณุฑูุนุฉ ุฃุซูุงุก ุงูุชุทููุฑ) -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        /* ุฎุทูุท ุนุฑุจูุฉ ูุชุญุณูู ุงูุดูู */
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap');
        body { font-family: 'Cairo', sans-serif; }

        /* ูุฅุธูุงุฑ ุงูุชุญุฏูุฏ ุนูู ุงููุทุงุน ุงูุฏุงุฆุฑู */
        .sector-selected {
            stroke: #3b82f6;
            stroke-width: 3px;
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.08));
        }

        /* ุชูุณูู ูุฑุจุนุงุช ุงูููุช */
        .time-segment { transition: all 0.15s; }
        .time-segment-selected {
            background-color: #3b82f6;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(59,130,246,0.18);
        }

        /* ุฃุฒุฑุงุฑ ุฃุณููุจ ุงูุชุนูู */
        .style-btn { transition: all 0.15s; }
        .style-btn-selected {
            background-color: #10b981;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(16,185,129,0.18);
        }

        /* ุชุญุณูู ุงูููุณ ูู ุงูุฌูุงู */
        button, select, input, textarea { min-height: 44px; }

        /* ุฎุตุงุฆุต ุงููุงูุฐุฉ ุงูููุจุซูุฉ ูุชููู ููุงุณุจุฉ ููุฌูุงู */
        #report-modal { z-index: 50; }
        #printable-card {
            width: 96%;
            max-width: 820px;
            margin: 0 12px;
            border-radius: 12px;
            overflow: hidden;
            max-height: 92vh;
        }

        /* ูุณูุญ ุจุงูุชูุฑูุฑ ุฏุงุฎู ุงูุจุทุงูุฉ ุฅุฐุง ูุงูุช ุทูููุฉ */
        #printable-card .p-6 { max-height: calc(92vh - 120px); overflow-y: auto; padding-right: 1rem; padding-left: 1rem; }

        /* ุชุญุณูู ูุญุงุฐุงุฉ ุงูููุฏุงู ุนูู ุงูุฌูุงู */
        @media (max-width: 640px) {
            #report-modal { align-items: flex-start; padding-top: 1.5rem; }
            #printable-card { width: 100%; margin: 0 8px; border-radius: 10px; }
            /* ุฌุนู ุงูุดุจูุงุช ุฐุงุช ุงูุนููุฏูู ุชุชุญูู ูุนููุฏ ูุงุญุฏ ูุฑุงุญุฉ ุงูุนุฑุถ */
            .responsive-2col { grid-template-columns: 1fr !important; }
            .time-segment { font-size: 0.92rem; padding: 0.6rem 0.75rem; }
            .text-3xl { font-size: 1.5rem; }
        }

        /* ููุน ุชูุฏุฏ ุบูุฑ ูุชููุน ูุจุนุถ ุงูุนูุงุตุฑ */
        input[type="text"], select { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        /* ุทุจุงุนุฉ ููุญุณูููุฉ */
        @media print {
            body * { visibility: hidden; }
            #printable-card, #printable-card * { visibility: visible; }
            #printable-card { position: absolute; left: 0; top: 0; width: 100%; margin: 0; box-shadow: none; }
            #close-modal-btn, #print-modal-btn { display: none; }
            /* ุงูุชุฃูุฏ ูู ุทุจุงุนุฉ ุงูุฃููุงู ุงูุฎูููุฉ */
            #report-activity-bar, #report-quality-indicator, .bg-green-600 { -webkit-print-color-adjust: exact; color-adjust: exact; }
        }

        /* ูุต ุฌูุฏุฉ ุงูุชูุงุนู ูุงุจู ููุงูุชูุงู */
        #report-quality-text { white-space: normal; line-height: 1.6; font-size: 0.95rem; }

        /* ูุณุงุญุงุช ุขููุฉ ุฏุงุฎู ุงูุนุฑูุถ ุงูุตุบูุฑุฉ */
        .safe-padding { padding-left: 0.5rem; padding-right: 0.5rem; }

    </style>
</head>
<body class="bg-gray-100 p-4 md:p-8">

    <div class="max-w-4xl mx-auto bg-white rounded-xl shadow-2xl overflow-hidden">
        <header class="bg-green-600 text-white p-5">
            <div class="flex justify-center items-center gap-3">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" />
                </svg>
                <h1 class="text-3xl font-bold text-center">ุงุฏุงุฉ ุงูููุช ุงููุนูู - ุซุงูููุฉ ุฏุงุฑ ุงูุชูุญูุฏ</h1>
            </div>
            <p class="text-lg text-center text-green-100 mt-1">ูุฏูุฑ ุงููุฏุฑุณุฉ: ููุฏ ุจู ุญุณู ุงููุญุทุงูู</p>
        </header>

        <main class="p-5 md:p-8">
            <!-- FORM -->
            <form id="observation-form" class="space-y-5">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label for="teacher-name" class="block text-sm font-semibold text-gray-700 mb-1">ุงุณู ุงููุนูู</label>
                        <input aria-label="ุงุณู ุงููุนูู" type="text" id="teacher-name" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                    <div>
                        <label for="subject" class="block text-sm font-semibold text-gray-700 mb-1">ุงููุงุฏุฉ</label>
                        <input aria-label="ุงููุงุฏุฉ" type="text" id="subject" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    </div>
                    <div>
                        <label for="class-name" class="block text-sm font-semibold text-gray-700 mb-1">ุงููุตู</label>
                        <select aria-label="ุงููุตู" id="class-name" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white" required>
                            <option value="" disabled selected>ุงุฎุชุฑ ุงููุตู...</option>
                            <option value="101">101</option>
                            <option value="102">102</option>
                            <option value="103">103</option>
                            <option value="104">104</option>
                            <option value="201">201</option>
                            <option value="202">202</option>
                            <option value="203">203</option>
                            <option value="301">301</option>
                            <option value="302">302</option>
                        </select>
                    </div>
                    <div>
                        <label for="location" class="block text-sm font-semibold text-gray-700 mb-1">ููุงู ุงูุชูููุฐ</label>
                        <select aria-label="ููุงู ุงูุชูููุฐ" id="location" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white">
                            <option value="ุงููุตู">ุงููุตู</option>
                            <option value="ูุงุนุฉ ุงูุชุฏุฑูุจ">ูุงุนุฉ ุงูุชุฏุฑูุจ</option>
                            <option value="ุงููุนูู">ุงููุนูู</option>
                            <option value="ุงููุฎุชุจุฑ">ุงููุฎุชุจุฑ</option>
                        </select>
                    </div>
                    <div class="md:col-span-1">
                        <label for="learning-event" class="block text-sm font-semibold text-gray-700 mb-1">ุงูุญุฏุซ ุงูุชุนูููู (ุฃุซูุงุก ุงูุฒูุงุฑุฉ)</label>
                        <select aria-label="ุงูุญุฏุซ ุงูุชุนูููู" id="learning-event" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white">
                            <option value="ุนุฑุถ">ุนุฑุถ (ุดุฑุญ)</option>
                            <option value="ุงููุนูู ูููู ุงูุทูุงุจ ูุณุชูุนูู">ุงููุนูู ููููุ ุงูุทูุงุจ ูุณุชูุนูู</option>
                            <option value="ูุดุงุท ุตูู">ูุดุงุท ุตูู (ูุฑุฏู/ุฌูุงุนู)</option>
                            <option value="ููุงูุดุฉ ูุญูุงุฑ">ููุงูุดุฉ ูุญูุงุฑ</option>
                            <option value="ุชูููู">ุชูููู (ุงุฎุชุจุงุฑ/ุณุคุงู)</option>
                            <option value="ุฃุฎุฑู">ุฃุฎุฑู</option>
                        </select>
                    </div>
                     <div class="md:col-span-1">
                        <label for="lesson-output" class="block text-sm font-semibold text-gray-700 mb-1">ูู ููุฌุฏ ูุฎุฑุฌุงุช ููุญุตุฉุ</label>
                        <select aria-label="ูุฎุฑุฌุงุช ุงูุญุตุฉ" id="lesson-output" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white">
                            <option value="ูุง ููุฌุฏ">ูุง ููุฌุฏ</option>
                            <option value="ูุฑู ุนูู">ูุฑู ุนูู</option>
                            <option value="ุชุฌุฑุจุฉ">ุชุฌุฑุจุฉ</option>
                            <option value="ุนูู ุชุนุงููู">ุนูู ุชุนุงููู</option>
                            <option value="ุญู ูุณุฃูุฉ">ุญู ูุณุฃูุฉ</option>
                        </select>
                    </div>
                </div>

                <!-- ููุช ุงูุญุตุฉ -->
                <div class="pt-4">
                    <label class="block text-lg font-semibold text-gray-800 mb-3 text-center">ุชูููุช ุงูุฑุตุฏ (ุจุงูุชุฑุงุถ ุงูุญุตุฉ 50 ุฏูููุฉ)</label>
                    <div class="grid grid-cols-5 gap-2">
                        <button type="button" class="time-segment text-sm md:text-base p-2 border border-gray-300 rounded-md shadow-sm hover:bg-gray-50" data-value="ุฏ 0-10">ุฏ 0-10</button>
                        <button type="button" class="time-segment text-sm md:text-base p-2 border border-gray-300 rounded-md shadow-sm hover:bg-gray-50" data-value="ุฏ 11-20">ุฏ 11-20</button>
                        <button type="button" class="time-segment text-sm md:text-base p-2 border border-gray-300 rounded-md shadow-sm hover:bg-gray-50" data-value="ุฏ 21-30">ุฏ 21-30</button>
                        <button type="button" class="time-segment text-sm md:text-base p-2 border border-gray-300 rounded-md shadow-sm hover:bg-gray-50" data-value="ุฏ 31-40">ุฏ 31-40</button>
                        <button type="button" class="time-segment text-sm md:text-base p-2 border border-gray-300 rounded-md shadow-sm hover:bg-gray-50" data-value="ุฏ 41-50">ุฏ 41-50</button>
                    </div>
                    <input type="hidden" id="time-segment-value" value="">
                </div>

                <!-- ุฃุณููุจ ุงูุชุนูู -->
                <div class="pt-4">
                    <label class="block text-lg font-semibold text-gray-800 mb-3 text-center">ุฃุณููุจ ุงูุชุนูู</label>
                    <div class="grid grid-cols-2 gap-4 responsive-2col">
                        <button type="button" class="style-btn p-3 border border-gray-300 rounded-md shadow-sm hover:bg-gray-50" data-value="ูุดุท">
                            <span class="text-xl">๐</span> ูุดุท
                        </button>
                        <button type="button" class="style-btn p-3 border border-gray-300 rounded-md shadow-sm hover:bg-gray-50" data-value="ุบูุฑ ูุดุท">
                            <span class="text-xl">๐</span> ุบูุฑ ูุดุท (ุชูููู)
                        </button>
                    </div>
                    <input type="hidden" id="learning-style-value" value="">
                </div>

                <!-- ูุดุงุท ุงูุทูุงุจ -->
                <div class="pt-4">
                    <label class="block text-lg font-semibold text-gray-800 mb-3 text-center">ููุงุญุธุฉ ูุดุงุท ุงูุทูุงุจ (ุงููุฑ ููุงุฎุชูุงุฑ)</label>
                    <div class="flex justify-center">
                        <svg id="activity-wheel" width="300" height="300" viewBox="0 0 100 100" class="max-w-full h-auto">
                            <path id="sector-low" data-value="< 50%" class="sector cursor-pointer transition-all duration-150 fill-red-500 hover:fill-red-600" d="M50,50 L50,5 A45,45 0 0,1 88.97, 65.00 Z"></path>
                            <path id="sector-mid" data-value="50%" class="sector cursor-pointer transition-all duration-150 fill-yellow-400 hover:fill-yellow-500" d="M50,50 L88.97, 65.00 A45,45 0 0,1 11.03, 65.00 Z"></path>
                            <path id="sector-high" data-value="100%" class="sector cursor-pointer transition-all duration-150 fill-green-500 hover:fill-green-600" d="M50,50 L11.03, 65.00 A45,45 0 0,1 50,5 Z"></path>
                            <text x="75" y="45" class="fill-white font-bold text-sm pointer-events-none">&lt; 50%</text>
                            <text x="50" y="83" class="fill-white font-bold text-sm pointer-events-none" text-anchor="middle">50%</text>
                            <text x="25" y="45" class="fill-white font-bold text-sm pointer-events-none">100%</text>
                        </svg>
                    </div>
                    <input type="hidden" id="student-activity-value" value="">
                    <p id="error-message" class="text-red-500 text-center mt-2 h-5"></p>
                </div>

                <!-- ููุงุญุธุงุช ุฅุถุงููุฉ -->
                <div class="pt-4">
                    <label class="block text-lg font-semibold text-gray-800 mb-3 text-center">ููุงุญุธุงุช ุฅุถุงููุฉ</label>
                    <div class="space-y-3 bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <label class="flex items-center cursor-pointer">
                            <input aria-label="ุฎููู/ููู/ุนุจุซ" type="checkbox" id="negative-observation" class="h-5 w-5 text-blue-600 rounded border-gray-300 focus:ring-blue-500">
                            <span class="mr-3 text-gray-700">ุชู ููุงุญุธุฉ ุฎููู / ููู / ุนุจุซ ุจุงูุฃุฌูุฒุฉ</span>
                        </label>
                        <label class="flex items-center cursor-pointer">
                            <input aria-label="ุงูุจูุฆุฉ ููุธูุฉ" type="checkbox" id="organized-env" class="h-5 w-5 text-blue-600 rounded border-gray-300 focus:ring-blue-500">
                            <span class="mr-3 text-gray-700">ุงูุจูุฆุฉ ุงูุตููุฉ ููุธูุฉ</span>
                        </label>
                    </div>
                </div>

                <!-- ุฒุฑ ุงูุชุณุฌูู -->
                <div class="pt-4">
                    <button type="submit" id="log-button" class="w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:bg-blue-700 transition duration-300 text-lg">
                        ุชุณุฌูู ูุนุฑุถ ุงูุจุทุงูุฉ
                    </button>
                </div>
            </form>
        </main>
    </div>

    <footer class="text-center text-gray-500 text-sm mt-4">ููุฑุฉ ูุชุตููู: ูุญูุฏ ูุฌููู</footer>

    <!-- Modal -->
    <div id="report-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-2xl mx-auto transform transition-all scale-95 opacity-0" id="printable-card" role="dialog" aria-modal="true" aria-labelledby="report-title">
            <div class="bg-green-600 text-white p-5 rounded-t-xl">
                <h2 id="report-title" class="text-2xl font-bold text-center">ุจุทุงูุฉ ููุงุญุธุฉ ุตููุฉ</h2>
                <p class="text-center text-green-100">ุซุงูููุฉ ุฏุงุฑ ุงูุชูุญูุฏ</p>
            </div>

            <div class="p-6 space-y-4 divide-y divide-gray-200">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-x-4 gap-y-3 pb-4 responsive-2col">
                    <div>
                        <span class="text-sm font-semibold text-gray-500">ุงููุนูู:</span>
                        <p class="text-lg font-bold text-gray-900" id="report-teacher"></p>
                    </div>
                    <div>
                        <span class="text-sm font-semibold text-gray-500">ุงููุงุฏุฉ:</span>
                        <p class="text-lg font-bold text-gray-900" id="report-subject"></p>
                    </div>
                    <div>
                        <span class="text-sm font-semibold text-gray-500">ุงููุตู:</span>
                        <p class="text-lg font-bold text-gray-900" id="report-class"></p>
                    </div>
                    <div>
                        <span class="text-sm font-semibold text-gray-500">ุชูููุช ุงูุฒูุงุฑุฉ:</span>
                        <p class="text-lg font-bold text-gray-900" id="report-time-segment"></p>
                    </div>
                     <div>
                        <span class="text-sm font-semibold text-gray-500">ุฃุณููุจ ุงูุชุนูู:</span>
                        <p class="text-lg font-bold text-gray-900" id="report-style"></p>
                    </div>
                    <div>
                        <span class="text-sm font-semibold text-gray-500">ุงูุญุฏุซ ุงูุชุนูููู:</span>
                        <p class="text-lg font-bold text-gray-900" id="report-event"></p>
                    </div>
                    <div class="md:col-span-3">
                        <span class="text-sm font-semibold text-gray-500">ูุฎุฑุฌุงุช ุงูุญุตุฉ:</span>
                        <p class="text-lg font-bold text-gray-900" id="report-output"></p>
                    </div>
                </div>

                <div class="pt-4 grid grid-cols-1 sm:grid-cols-2 gap-4 responsive-2col">
                     <div>
                        <span class="text-sm font-semibold text-gray-500">ุงูุจูุฆุฉ ุงูุตููุฉ:</span>
                        <p class="text-lg font-bold" id="report-organized-env"></p>
                    </div>
                    <div>
                        <span class="text-sm font-semibold text-gray-500">ููุงุญุธุงุช ุณูุจูุฉ (ุฎููู/ุนุจุซ):</span>
                        <p class="text-lg font-bold" id="report-negative-obs"></p>
                    </div>
                </div>

                <div class="pt-4">
                    <span class="text-sm font-semibold text-gray-500">ูุณุชูู ูุดุงุท ุงูุทูุงุจ:</span>
                    <div class="flex items-center space-x-3" dir="ltr">
                        <div class="w-full bg-gray-200 rounded-full h-5 overflow-hidden">
                            <div id="report-activity-bar" class="h-5 rounded-full transition-all duration-500 ease-out"></div>
                        </div>
                        <span class="text-lg font-bold" id="report-activity-value"></span>
                    </div>
                </div>

                <div class="pt-4">
                    <span class="text-sm font-semibold text-gray-500">ูุคุดุฑ ุฌูุฏุฉ ุงูุชูุงุนู:</span>
                    <div id="report-quality-indicator" class="p-3 rounded-lg mt-2">
                        <p id="report-quality-text" class="font-semibold text-center"></p>
                    </div>
                </div>

                <div class="pt-4 grid grid-cols-2 gap-4">
                    <button id="print-modal-btn" class="w-full bg-green-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-green-700 transition duration-300">ุทุจุงุนุฉ</button>
                    <button id="close-modal-btn" class="w-full bg-gray-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-600 transition duration-300">ุฅุบูุงู</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('observation-form');
            const errorMessage = document.getElementById('error-message');

            const sectors = document.querySelectorAll('.sector');
            const activityValueInput = document.getElementById('student-activity-value');

            const timeSegments = document.querySelectorAll('.time-segment');
            const timeSegmentValueInput = document.getElementById('time-segment-value');

            const styleButtons = document.querySelectorAll('.style-btn');
            const learningStyleInput = document.getElementById('learning-style-value');

            const reportModal = document.getElementById('report-modal');
            const modalCard = document.getElementById('printable-card');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const printModalBtn = document.getElementById('print-modal-btn');

            const reportTeacher = document.getElementById('report-teacher');
            const reportSubject = document.getElementById('report-subject');
            const reportClass = document.getElementById('report-class');
            const reportTimeSegment = document.getElementById('report-time-segment');
            const reportEvent = document.getElementById('report-event');
            const reportStyle = document.getElementById('report-style');
            const reportOutput = document.getElementById('report-output');
            const reportActivityBar = document.getElementById('report-activity-bar');
            const reportActivityValue = document.getElementById('report-activity-value');
            const reportQualityIndicator = document.getElementById('report-quality-indicator');
            const reportQualityText = document.getElementById('report-quality-text');

            const negativeObsCheckbox = document.getElementById('negative-observation');
            const organizedEnvCheckbox = document.getElementById('organized-env');
            const reportOrganizedEnv = document.getElementById('report-organized-env');
            const reportNegativeObs = document.getElementById('report-negative-obs');

            // ุฏุงุฆุฑุฉ ุงููุดุงุท: ุงูุชุนุงูู ูุน ุงูููุฑ
            sectors.forEach(sector => {
                sector.addEventListener('click', (e) => {
                    sectors.forEach(s => s.classList.remove('sector-selected'));
                    const selectedSector = e.target.closest('.sector');
                    if (!selectedSector) return;
                    selectedSector.classList.add('sector-selected');
                    activityValueInput.value = selectedSector.dataset.value;
                    errorMessage.textContent = '';
                });
            });

            // ูุฑุจุนุงุช ุงูุชูููุช
            timeSegments.forEach(segment => {
                segment.addEventListener('click', (e) => {
                    timeSegments.forEach(s => s.classList.remove('time-segment-selected'));
                    const selectedSegment = e.target.closest('.time-segment');
                    if (!selectedSegment) return;
                    selectedSegment.classList.add('time-segment-selected');
                    timeSegmentValueInput.value = selectedSegment.dataset.value;
                    errorMessage.textContent = '';
                });
            });

            // ุฃุณููุจ ุงูุชุนูู
            styleButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    styleButtons.forEach(s => s.classList.remove('style-btn-selected'));
                    const selectedButton = e.target.closest('.style-btn');
                    if (!selectedButton) return;
                    selectedButton.classList.add('style-btn-selected');
                    learningStyleInput.value = selectedButton.dataset.value;
                    errorMessage.textContent = '';
                });
            });

            function calculateQuality(activity, time, style, organized, negative, event) {
                const lateTime = (time === 'ุฏ 31-40' || time === 'ุฏ 41-50');
                const midTime = (time === 'ุฏ 21-30');
                const earlyTime = (time === 'ุฏ 0-10' || time === 'ุฏ 11-20');

                let messages = [];
                let color = 'yellow';

                if (activity === '100%') {
                    if (lateTime) { messages.push("ุชูุงุนู ููุชุงุฒ! ุงูุญูุงุธ ุนูู ุงููุดุงุท (100%) ูููุงูุฉ ุงูุญุตุฉ ูุฏู ุนูู ุฌูุฏุฉ ุนุงููุฉ."); color = 'green'; }
                    else if (midTime) { messages.push("ุชูุงุนู ููุชุงุฒ (100%) ูู ููุชุตู ุงูุญุตุฉ."); color = 'green'; }
                    else { messages.push("ุจุฏุงูุฉ ูููุฉ ูุชูุงุนู 100%."); color = 'yellow'; }
                } else if (activity === '50%') {
                    if (lateTime) messages.push("ุชูุงุนู ุฌูุฏ (50%)ุ ููู ููุงุญุธ ูุจูุท ูู ูุณุชูู ุงููุดุงุท ููุงูุฉ ุงูุญุตุฉ.");
                    else if (midTime) messages.push("ุชูุงุนู ูุชูุณุท (50%)ุ ูููู ุชุญููุฒ ุงูุทูุงุจ ุฃูุซุฑ.");
                    else messages.push("ุจุฏุงูุฉ ูุชูุณุทุฉ (50%)ุ ุชุญุชุงุฌ ูุฌุฐุจ ุงูุชุจุงู ุฃูุจุฑ.");
                    color = 'yellow';
                } else if (activity === '< 50%') {
                    messages.push("ุงูุชุจุงู ููุฎูุถ (< 50%).");
                    if (lateTime) messages.push("ุงูููุช ูุชุฃุฎุฑ ููุฐุง ุงูุงูุฎูุงุถ ูุฏ ูููู ูุชููุนุ ูููู ูุญุชุงุฌ ูุนุงูุฌุฉ.");
                    else messages.push("ูุฌุจ ูุฑุงุฌุนุฉ ุงุณุชุฑุงุชูุฌูุงุช ุฌุฐุจ ุงูุงูุชุจุงู.");
                    color = 'red';
                }

                if (style === 'ุบูุฑ ูุดุท' || event === 'ุงููุนูู ูููู ุงูุทูุงุจ ูุณุชูุนูู') {
                    messages.push("ููุญุธ ุงุนุชูุงุฏ ุนูู 'ุงูุชูููู'.");
                    if (color === 'red') messages.push("ูุฏ ูููู ุงูุชูููู ุณุจุจ ุงูุฎูุงุถ ุงูุชูุงุนู.");
                    else if (color === 'green') messages.push("ุฑุบู ุฐููุ ูุงู ุงูุถุจุงุท ุงูุทูุงุจ ุนุงููุงู.");
                }

                if (style === 'ูุดุท' && color === 'red') {
                    messages.push("ุฑุบู ุชุทุจูู ุฃุณููุจ 'ูุดุท'ุ ุงูุชูุงุนู ููุฎูุถ. ูุฏ ูุญุชุงุฌ ุงููุดุงุท ููุฑุงุฌุนุฉ ุฃู ุชุญููุฒ ุฅุถุงูู.");
                }

                if (!organized) {
                    messages.push("ุงูุจูุฆุฉ ุงูุตููุฉ 'ุบูุฑ ููุธูุฉ'ุ ูุฏ ูุคุซุฑ ุฐูู ุนูู ุงูุชุฑููุฒ.");
                    if (color === 'green') color = 'yellow';
                }

                if (negative) {
                    messages.push("ุชู ุฑุตุฏ ุฎููู/ุนุจุซุ ููุฐุง ูุคุดุฑ ุฎุทูุฑ ูุชุทูุจ ูุนุงูุฌุฉ ููุฑูุฉ.");
                    color = 'red';
                }

                let finalText = messages.join(' ');
                if (finalText.length === 0) finalText = "ุชู ุชุณุฌูู ุงูููุงุญุธุฉ.";

                return { text: finalText, color: color };
            }

            form.addEventListener('submit', (e) => {
                e.preventDefault();

                const teacherName = document.getElementById('teacher-name').value.trim();
                const subject = document.getElementById('subject').value.trim();
                const className = document.getElementById('class-name').value;
                const learningEvent = document.getElementById('learning-event').value;
                const lessonOutput = document.getElementById('lesson-output').value;
                const studentActivity = activityValueInput.value;
                const timeSegment = timeSegmentValueInput.value;
                const learningStyle = learningStyleInput.value;

                const negativeObs = negativeObsCheckbox.checked;
                const organizedEnv = organizedEnvCheckbox.checked;

                if (!teacherName || !subject || !className) {
                    errorMessage.textContent = 'ุงูุฑุฌุงุก ุชุนุจุฆุฉ ุญููู ุงููุนูู ูุงููุงุฏุฉ ูุงููุตู.';
                    return;
                }
                if (!timeSegment) { errorMessage.textContent = 'ุงูุฑุฌุงุก ุงุฎุชูุงุฑ ุชูููุช ุงูุฑุตุฏ ูู ุงููุฑุจุนุงุช.'; return; }
                if (!learningStyle) { errorMessage.textContent = 'ุงูุฑุฌุงุก ุงุฎุชูุงุฑ ุฃุณููุจ ุงูุชุนูู.'; return; }
                if (!studentActivity) { errorMessage.textContent = 'ุงูุฑุฌุงุก ุงุฎุชูุงุฑ ูุณุจุฉ ูุดุงุท ุงูุทูุงุจ ูู ุงูุฏุงุฆุฑุฉ.'; return; }

                // ุชุนุจุฆุฉ ุงูุจุทุงูุฉ
                reportTeacher.textContent = teacherName;
                reportSubject.textContent = subject;
                reportClass.textContent = className;
                reportTimeSegment.textContent = timeSegment;
                reportEvent.textContent = learningEvent;
                reportStyle.textContent = learningStyle;
                reportOutput.textContent = lessonOutput;
                reportActivityValue.textContent = studentActivity;

                reportOrganizedEnv.textContent = organizedEnv ? "ููุธูุฉ" : "ุบูุฑ ููุธูุฉ";
                reportOrganizedEnv.className = organizedEnv ? "text-lg font-bold text-green-600" : "text-lg font-bold text-red-600";
                reportNegativeObs.textContent = negativeObs ? "ุชู ููุงุญุธุชูุง" : "ูุง ููุฌุฏ";
                reportNegativeObs.className = negativeObs ? "text-lg font-bold text-red-600" : "text-lg font-bold text-green-600";

                // ุชุญุฏูุซ ุดุฑูุท ุงููุดุงุท
                reportActivityBar.classList.remove('bg-green-500', 'bg-yellow-500', 'bg-red-500', 'w-full', 'w-1/2', 'w-1/4');
                if (studentActivity === '100%') reportActivityBar.classList.add('bg-green-500', 'w-full');
                else if (studentActivity === '50%') reportActivityBar.classList.add('bg-yellow-500', 'w-1/2');
                else reportActivityBar.classList.add('bg-red-500', 'w-1/4');

                const quality = calculateQuality(studentActivity, timeSegment, learningStyle, organizedEnv, negativeObs, learningEvent);
                reportQualityText.textContent = quality.text;
                reportQualityIndicator.classList.remove('bg-green-100','text-green-800','bg-yellow-100','text-yellow-800','bg-red-100','text-red-800');
                if (quality.color === 'green') reportQualityIndicator.classList.add('bg-green-100','text-green-800');
                else if (quality.color === 'yellow') reportQualityIndicator.classList.add('bg-yellow-100','text-yellow-800');
                else reportQualityIndicator.classList.add('bg-red-100','text-red-800');

                // ูุชุญ ุงูููุฏุงู ูุน ุชุฃุซูุฑ
                reportModal.classList.remove('hidden');
                setTimeout(() => {
                    modalCard.classList.remove('scale-95','opacity-0');
                    modalCard.classList.add('scale-100','opacity-100');
                }, 60);

                // ุฅุนุงุฏุฉ ุชุนููู ุงูููุฑู
                form.reset();
                activityValueInput.value = '';
                timeSegmentValueInput.value = '';
                learningStyleInput.value = '';
                document.getElementById('lesson-output').value = 'ูุง ููุฌุฏ';
                document.getElementById('class-name').value = '';

                negativeObsCheckbox.checked = false;
                organizedEnvCheckbox.checked = false;

                sectors.forEach(s => s.classList.remove('sector-selected'));
                timeSegments.forEach(s => s.classList.remove('time-segment-selected'));
                styleButtons.forEach(s => s.classList.remove('style-btn-selected'));
                errorMessage.textContent = '';
            });

            function closeModal() {
                modalCard.classList.add('scale-95','opacity-0');
                setTimeout(() => {
                    reportModal.classList.add('hidden');
                    modalCard.classList.remove('scale-100','opacity-100');
                }, 250);
            }

            closeModalBtn.addEventListener('click', closeModal);
            reportModal.addEventListener('click', (e) => { if (e.target === reportModal) closeModal(); });

            printModalBtn.addEventListener('click', () => { window.print(); });

            // ุชุญุณููุงุช ุทูููุฉ: ุฏุนู ููุญุฉ ุงูููุงุชูุญ (Enter) ูุฒุฑ ุงูุชุณุฌูู ุนูุฏูุง ูููู ูู ุญูู
            document.getElementById('teacher-name').addEventListener('keydown', (e) => { if (e.key === 'Enter') e.preventDefault(); });
        });
    </script>
</body>
</html>
