<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <!-- 
      ุงูุชุนุฏูู 2: ุถุจุท ุงูููุงููุณ ูููุน ุงูุชูุฏุฏ ุงูุนุฑุถู ูู ุงูุฌูุงู
      ุชู ุงุณุชุจุฏุงู ุงููุณู ุงููุฏูู ุจูุฐุง ุงููุณู 
    -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ุงุฏุงุฉ ุงูููุช ุงููุนูู - ุซุงูููุฉ ุฏุงุฑ ุงูุชูุญูุฏ</title>
    <!-- ุชุญููู Tailwind CSS ูููุงุฌูุฉ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- ููุชุจุงุช ุชุตุฏูุฑ PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        /* ุฎุทูุท ุนุฑุจูุฉ ูุชุญุณูู ุงูุดูู */
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap');
        body {
            font-family: 'Cairo', sans-serif;
            min-height: 100vh;
        }
        /* ูุฅุธูุงุฑ ุงูุชุญุฏูุฏ ุนูู ุงููุทุงุน ุงูุฏุงุฆุฑู */
        .sector-selected {
            stroke: #3b82f6; /* ููู ุฃุฒุฑู */
            stroke-width: 4px;
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.1));
        }
        /* ุชูุณูู ูุฑุจุนุงุช ุงูููุช */
        .time-segment {
            transition: all 0.2s;
        }
        .time-segment-selected {
            background-color: #3b82f6; /* ุฃุฒุฑู */
            color: white;
            transform: scale(1.05);
            box-shadow: 0 4px 6px rgba(59, 130, 246, 0.5);
        }
        /* ุชูุณูู ุฃุฒุฑุงุฑ ุฃุณููุจ ุงูุชุนูู */
        .style-btn {
            transition: all 0.2s;
        }
        .style-btn-selected {
            background-color: #10b981; /* ุฃุฎุถุฑ */
            color: white;
            transform: scale(1.05);
            box-shadow: 0 4px 6px rgba(16, 185, 129, 0.5);
        }

        /* ุชูุณููุงุช ุงูุทุจุงุนุฉ */
        @media print {
            body * {
                visibility: hidden;
            }
            /* ุฅุธูุงุฑ ุงูุจุทุงูุฉ ููุท ุนูุฏ ุงูุทุจุงุนุฉ */
            #printable-card, #printable-card * {
                visibility: visible !important;
            }
            #printable-card {
                position: absolute; /* ููู ูุชุธูุฑ ููู ูู ุดูุก */
                top: 0;
                left: 0;
                width: 95%; /* ุชุญุฏูุฏ ุนุฑุถ ููุงุณุจ ููุทุจุงุนุฉ */
                margin: 1rem auto; /* ุชูุณูุท ุฃููู ูุน ูุงูุด ุนููู */
                padding: 0;
                border: none;
                box-shadow: none;
                -webkit-print-color-adjust: exact;
                color-adjust: exact;
            }
            #close-modal-btn, #print-modal-btn {
                display: none;
            }
            /* Ensure backgrounds print */
            #report-activity-bar, #report-quality-indicator, .bg-green-600 {
                -webkit-print-color-adjust: exact;
                color-adjust: exact;
            }
        }
        
        /* ---
        ุงูุชุนุฏููุงุช ุงูููุชุฑุญุฉ ูุชุญุณูู ุนุฑุถ ุงูุฌูุงู
        --- */
        
        /* ุงูุชุนุฏูู 3: ุชุญุณูู ุงูุชูุงุนู ูุน ุงูุฃุฒุฑุงุฑ ุงูุตุบูุฑุฉ (ุฃูุฏุงู ุงูููุณ) */
        button, select, input {
            min-height: 44px; /* ุญุณุจ ูุนุงููุฑ ุงูููุณ ูู ุงูุฌูุงู */
        }
        
        /* ุงูุชุนุฏูู 5: ุฌุนู ูุตูุต ุงูุชูุฑูุฑ ูุงุจูุฉ ููุทู */
        #report-quality-text {
            white-space: normal; /* ุงูุณูุงุญ ุจุงูุทู ุงูุชููุงุฆู */
            line-height: 1.6;
            font-size: 0.95rem;
            text-align: right; /* ูุญุงุฐุงุฉ ุงููุต ูููููู ูุชุญุณูู ุงููุฑุงุกุฉ */
        }
        
        /* ุงูุชุนุฏูู ุงูุฎุงุต ุจุญูู ุงูููุงุญุธุงุช ูุฌุนูู ูุงุจูุงู ููุทู ูู ุงูุจุทุงูุฉ */
        #report-observer-notes {
            white-space: pre-wrap; /* ููุญูุงุธ ุนูู ุชูุณูู ุงูุฃุณุทุฑ ุงูุฌุฏูุฏุฉ */
            line-height: 1.6;
            border-right: 4px solid #3b82f6; /* ุดุฑูุท ุฌุงูุจู ุฃุฒุฑู */
            padding-right: 1rem;
            background-color: #f7f9fc;
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            margin-top: 0.5rem;
        }

        /* ุฅุฒุงูุฉ ูููุฏ ุงูุงุฑุชูุงุน ุงูุฃูุตู (#printable-card) ูู CSS
           ููุณูุงุญ ููุง ุจุงูุชูุฏุฏ ุงููุงูู ูู ูุถุน ุงูุนุฑุถ ุงูุนุงุฏู
        */
        
        /* ููุงุนุฏ ุฎุงุตุฉ ุจุงูุดุงุดุงุช ุงูุตุบูุฑุฉ (ุงูุฌูุงู) */
        @media (max-width: 640px) {
            #printable-card {
                width: 100%;
                border-radius: 1rem; 
            }
            .grid.grid-cols-2.gap-4 {
                grid-template-columns: 1fr; /* ุนููุฏ ูุงุญุฏ */
            }
        }
        
        /* ุชูุณูู ูุตูุต ุงููุณุจ ุฏุงุฎู ุงูุฏุงุฆุฑุฉ */
        .sector-text {
            fill: white; 
            font-weight: bold; 
            font-size: 0.3em; /* ุญุฌู ุตุบูุฑ ููุงุณุจ ููุฑุคูุฉ ุฏุงุฎู ุงููุทุงุน */
            text-anchor: middle;
            pointer-events: none; /* ูุง ุชุชูุงุนู ูุน ุงููุงูุณ ูุชูุฑูุฑ ุงูููุฑ ุฅูู ุงููุทุงุน */
        }
    </style>
</head>
<body class="bg-gray-100 p-4 md:p-8">

    <div id="main-container" class="max-w-4xl mx-auto">
        <div class="bg-white rounded-xl shadow-2xl overflow-hidden">
            <header class="bg-green-600 text-white p-5">
                <div class="flex justify-center items-center gap-3">
                    <!-- SVG Icon: Clipboard List -->
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" />
                    </svg>
                    <h1 class="text-3xl font-bold text-center">ุงุฏุงุฉ ุงูููุช ุงููุนูู - ุซุงูููุฉ ุฏุงุฑ ุงูุชูุญูุฏ</h1>
                </div>
                <p class="text-lg text-center text-green-100 mt-1">ูุฏูุฑ ุงููุฏุฑุณุฉ: ููุฏ ุจู ุญุณู ุงููุญุทุงูู</p>
            </header>
    
            <main class="p-5 md:p-8">
                <!-- ูุณู ุฅุฏุฎุงู ุงูุจูุงูุงุช (ุงููููุฐุฌ) -->
                <form id="observation-form" class="space-y-5">
                    
                    <!-- ุดุจูุฉ ูุชุฑุชูุจ ุงูุญููู -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="teacher-name" class="block text-sm font-semibold text-gray-700 mb-1">ุงุณู ุงููุนูู</label>
                            <input type="text" id="teacher-name" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                        </div>
                        <div>
                            <label for="subject" class="block text-sm font-semibold text-gray-700 mb-1">ุงููุงุฏุฉ</label>
                            <input type="text" id="subject" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                        </div>
                        <div>
                            <label for="class-name" class="block text-sm font-semibold text-gray-700 mb-1">ุงููุตู</label>
                            <select id="class-name" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white" required>
                                <option value="" disabled selected>ุงุฎุชุฑ ุงููุตู...</option>
                                <option value="101">101</option>
                                <option value="102">102</option>
                                <option value="103">103</option>
                                <option value="104">104</option>
                                <option value="201">201</option>
                                <option value="202">202</option>
                                <option value="203">203</option>
                                <option value="301">301</option>
                                <option value="302">302</option>
                            </select>
                        </div>
                        <div>
                            <label for="location" class="block text-sm font-semibold text-gray-700 mb-1">ููุงู ุงูุชูููุฐ</label>
                            <select id="location" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white">
                                <option value="ุงููุตู">ุงููุตู</option>
                                <option value="ูุงุนุฉ ุงูุชุฏุฑูุจ">ูุงุนุฉ ุงูุชุฏุฑูุจ</option>
                                <option value="ุงููุนูู">ุงููุนูู</option>
                                <option value="ุงููุฎุชุจุฑ">ุงููุฎุชุจุฑ</option>
                            </select>
                        </div>
                        <div class="md:col-span-1">
                            <label for="learning-event" class="block text-sm font-semibold text-gray-700 mb-1">ุงูุญุฏุซ ุงูุชุนูููู (ุฃุซูุงุก ุงูุฒูุงุฑุฉ)</label>
                            <select id="learning-event" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white">
                                <option value="ุนุฑุถ">ุนุฑุถ (ุดุฑุญ)</option>
                                <option value="ุงููุนูู ูููู ุงูุทูุงุจ ูุณุชูุนูู">ุงููุนูู ููููุ ุงูุทูุงุจ ูุณุชูุนูู</option>
                                <option value="ูุดุงุท ุตูู">ูุดุงุท ุตูู (ูุฑุฏู/ุฌูุงุนู)</option>
                                <option value="ููุงูุดุฉ ูุญูุงุฑ">ููุงูุดุฉ ูุญูุงุฑ</option>
                                <option value="ุชูููู">ุชูููู (ุงุฎุชุจุงุฑ/ุณุคุงู)</option>
                                <option value="ุฃุฎุฑู">ุฃุฎุฑู</option>
                            </select>
                        </div>
                         <div class="md:col-span-1">
                            <label for="lesson-output" class="block text-sm font-semibold text-gray-700 mb-1">ูู ููุฌุฏ ูุฎุฑุฌุงุช ููุญุตุฉุ</label>
                            <select id="lesson-output" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white">
                                <option value="ูุง ููุฌุฏ">ูุง ููุฌุฏ</option>
                                <option value="ูุฑู ุนูู">ูุฑู ุนูู</option>
                                <option value="ุชุฌุฑุจุฉ">ุชุฌุฑุจุฉ</option>
                                <option value="ุนูู ุชุนุงููู">ุนูู ุชุนุงููู</option>
                                <option value="ุญู ูุณุฃูุฉ">ุญู ูุณุฃูุฉ</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- ุฅุถุงูุฉ ุญูู ุงูููุงุญุธุงุช ุงููุตูุฉ ุงูุฌุฏูุฏุฉ -->
                    <div class="pt-4 md:col-span-2">
                        <label for="observer-notes" class="block text-lg font-semibold text-gray-800 mb-2">ููุงุญุธุงุช ุงูุฒุงุฆุฑ ุงููุตูุฉ (ุชุนููู ุชูุตููู)</label>
                        <textarea id="observer-notes" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea>
                    </div>
    
                    <!-- ูุณู ููุช ุงูุญุตุฉ -->
                    <div class="pt-4">
                        <label class="block text-lg font-semibold text-gray-800 mb-3 text-center">ุชูููุช ุงูุฑุตุฏ (ุจุงูุชุฑุงุถ ุงูุญุตุฉ 50 ุฏูููุฉ)</label>
                        <div class="grid grid-cols-5 gap-2">
                            <button type="button" class="time-segment text-sm md:text-base p-2 border border-gray-300 rounded-md shadow-sm hover:bg-gray-50" data-value="ุฏ 0-10">ุฏ 0-10</button>
                            <button type="button" class="time-segment text-sm md:text-base p-2 border border-gray-300 rounded-md shadow-sm hover:bg-gray-50" data-value="ุฏ 11-20">ุฏ 11-20</button>
                            <button type="button" class="time-segment text-sm md:text-base p-2 border border-gray-300 rounded-md shadow-sm hover:bg-gray-50" data-value="ุฏ 21-30">ุฏ 21-30</button>
                            <button type="button" class="time-segment text-sm md:text-base p-2 border border-gray-300 rounded-md shadow-sm hover:bg-gray-50" data-value="ุฏ 31-40">ุฏ 31-40</button>
                            <button type="button" class="time-segment text-sm md:text-base p-2 border border-gray-300 rounded-md shadow-sm hover:bg-gray-50" data-value="ุฏ 41-50">ุฏ 41-50</button>
                        </div>
                        <input type="hidden" id="time-segment-value" value="">
                    </div>
    
                    <!-- ูุณู ุฃุณููุจ ุงูุชุนูู -->
                    <div class="pt-4">
                        <label class="block text-lg font-semibold text-gray-800 mb-3 text-center">ุฃุณููุจ ุงูุชุนูู</label>
                        <div class="grid grid-cols-2 gap-4">
                            <button type="button" class="style-btn p-3 border border-gray-300 rounded-md shadow-sm hover:bg-gray-50" data-value="ูุดุท">
                                <span class="text-xl">๐</span> ูุดุท
                            </button>
                            <button type="button" class="style-btn p-3 border border-gray-300 rounded-md shadow-sm hover:bg-gray-50" data-value="ุบูุฑ ูุดุท">
                                <span class="text-xl">๐</span> ุบูุฑ ูุดุท (ุชูููู)
                            </button>
                        </div>
                        <input type="hidden" id="learning-style-value" value="">
                    </div>
    
                    <!-- ูุณู ููุงุญุธุฉ ูุดุงุท ุงูุทูุงุจ -->
                    <div class="pt-4">
                        <label class="block text-lg font-semibold text-gray-800 mb-3 text-center">ููุงุญุธุฉ ูุดุงุท ุงูุทูุงุจ (ุงููุฑ ููุงุฎุชูุงุฑ)</label>
                        <div class="flex justify-center">
                            <!-- ุชู ุชุนุฏูู ุงูุฏุงุฆุฑุฉ ุงูุฑุณูููุฉ ูุชุญุณูู ุงููุธูุฑ ูุชูุณูุท ุงููุตูุต -->
                            <svg id="activity-wheel" width="300" height="300" viewBox="0 0 100 100" class="max-w-full h-auto">
                                <!-- ุงูุฎูููุฉ ุงูุฏุงุฆุฑูุฉ ุงููุงููุฉ -->
                                <circle cx="50" cy="50" r="45" fill="#e5e7eb"/>

                                <!-- ุงููุทุงุน ุงูุฑุงุจุน: ููุฎูุถ ุฌุฏุงู (< 25%) - ุงูุฒุงููุฉ ูู 90 ุฅูู 180 -->
                                <path id="sector-very-low" data-value="< 25%" 
                                      class="sector cursor-pointer transition-all duration-150 fill-red-700 hover:fill-red-800" 
                                      d="M50,50 L50,5 A45,45 0 0,1 5,50 Z"></path>
                                <text x="25" y="25" class="sector-text">&lt; 25%</text>

                                <!-- ุงููุทุงุน ุงูุซุงูุซ: ูุชูุณุท (25% - 50%) - ุงูุฒุงููุฉ ูู 0 ุฅูู 90 -->
                                <path id="sector-low" data-value="25% - 50%" 
                                      class="sector cursor-pointer transition-all duration-150 fill-red-500 hover:fill-red-600" 
                                      d="M50,50 L5,50 A45,45 0 0,1 50,95 Z"></path>
                                <text x="25" y="75" class="sector-text">25% - 50%</text>

                                <!-- ุงููุทุงุน ุงูุซุงูู: ุนุงูู (50% - 75%) - ุงูุฒุงููุฉ ูู 270 ุฅูู 0 -->
                                <path id="sector-mid" data-value="50% - 75%" 
                                      class="sector cursor-pointer transition-all duration-150 fill-yellow-400 hover:fill-yellow-500" 
                                      d="M50,50 L50,95 A45,45 0 0,1 95,50 Z"></path>
                                <text x="75" y="75" class="sector-text">50% - 75%</text>

                                <!-- ุงููุทุงุน ุงูุฃูู: ูุฑุชูุน ุฌุฏุงู (75% - 100%) - ุงูุฒุงููุฉ ูู 180 ุฅูู 270 -->
                                <path id="sector-high" data-value="75% - 100%" 
                                      class="sector cursor-pointer transition-all duration-150 fill-green-500 hover:fill-green-600" 
                                      d="M50,50 L95,50 A45,45 0 0,1 50,5 Z"></path>
                                <text x="75" y="25" class="sector-text">75% - 100%</text>
                                
                                <circle cx="50" cy="50" r="10" fill="#fff" stroke="#3b82f6" stroke-width="2"/>
                            </svg>
                        </div>
                        <input type="hidden" id="student-activity-value" value="">
                        <!-- ุฑุณุงูุฉ ุฎุทุฃ -->
                        <p id="error-message" class="text-red-500 text-center mt-2 h-5"></p>
                    </div>
    
                    <!-- ูุณู ููุงุญุธุงุช ุฅุถุงููุฉ -->
                    <div class="pt-4">
                        <label class="block text-lg font-semibold text-gray-800 mb-3 text-center">ููุงุญุธุงุช ุฅุถุงููุฉ</label>
    
                        <div class="space-y-3 bg-gray-50 p-4 rounded-lg border border-gray-200">
                            <label class="flex items-center cursor-pointer">
                                <input type="checkbox" id="negative-observation" class="h-5 w-5 text-blue-600 rounded border-gray-300 focus:ring-blue-500">
                                <span class="mr-3 text-gray-700">ุชู ููุงุญุธุฉ ุฎููู / ููู / ุนุจุซ ุจุงูุฃุฌูุฒุฉ</span>
                            </label>
                            <label class="flex items-center cursor-pointer">
                                <input type="checkbox" id="organized-env" class="h-5 w-5 text-blue-600 rounded border-gray-300 focus:ring-blue-500">
                                <span class="mr-3 text-gray-700">ุงูุจูุฆุฉ ุงูุตููุฉ ููุธูุฉ</span>
                            </label>
                        </div>
                    </div>
    
    
                    <!-- ุฒุฑ ุงูุชุณุฌูู -->
                    <div class="pt-4">
                        <button type="submit" id="log-button" class="w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:bg-blue-700 transition duration-300 text-lg">
                            ุชุณุฌูู ูุนุฑุถ ุงูุจุทุงูุฉ
                        </button>
                    </div>
                </form>
                
                <!-- ุจุทุงูุฉ ุงูุชูุฑูุฑ (ุชู ููููุง ูู Modal) -->
                <div class="bg-white rounded-xl shadow-2xl w-full max-w-2xl mx-auto hidden" id="printable-card">
                    <!-- ุฑุฃุณ ุงูุจุทุงูุฉ -->
                    <div class="bg-green-600 text-white p-5 rounded-t-xl">
                        <h2 class="text-2xl font-bold text-center">ุจุทุงูุฉ ููุงุญุธุฉ ุตููุฉ</h2>
                        <p class="text-center text-green-100">ุซุงูููุฉ ุฏุงุฑ ุงูุชูุญูุฏ</p>
                    </div>
                    
                    <!-- ุฌุณู ุงูุจุทุงูุฉ -->
                    <div class="p-6 space-y-4 divide-y divide-gray-200">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-x-4 gap-y-3 pb-4">
                            <div>
                                <span class="text-sm font-semibold text-gray-500">ุงููุนูู:</span>
                                <p class="text-lg font-bold text-gray-900" id="report-teacher"></p>
                            </div>
                            <div>
                                <span class="text-sm font-semibold text-gray-500">ุงููุงุฏุฉ:</span>
                                <p class="text-lg font-bold text-gray-900" id="report-subject"></p>
                            </div>
                            <div>
                                <span class="text-sm font-semibold text-gray-500">ุงููุตู:</span>
                                <p class="text-lg font-bold text-gray-900" id="report-class"></p>
                            </div>
                            <div>
                                <span class="text-sm font-semibold text-gray-500">ุชูููุช ุงูุฒูุงุฑุฉ:</span>
                                <p class="text-lg font-bold text-gray-900" id="report-time-segment"></p>
                            </div>
                             <div>
                                <span class="text-sm font-semibold text-gray-500">ุฃุณููุจ ุงูุชุนูู:</span>
                                <p class="text-lg font-bold text-gray-900" id="report-style"></p>
                            </div>
                            <div>
                                <span class="text-sm font-semibold text-gray-500">ุงูุญุฏุซ ุงูุชุนูููู:</span>
                                <p class="text-lg font-bold text-gray-900" id="report-event"></p>
                            </div>
                            <div class="md:col-span-3">
                                <span class="text-sm font-semibold text-gray-500">ูุฎุฑุฌุงุช ุงูุญุตุฉ:</span>
                                <p class="text-lg font-bold text-gray-900" id="report-output"></p>
                            </div>
                        </div>
                        
                        <!-- ูุณู ุงูููุงุญุธุงุช ุงููุตูุฉ ุงูุฌุฏูุฏุฉ ูู ุงูุจุทุงูุฉ -->
                        <div class="pt-4">
                            <span class="text-sm font-semibold text-gray-500">ููุงุญุธุงุช ุงูุฒุงุฆุฑ:</span>
                            <p class="text-base text-gray-800 mt-1" id="report-observer-notes"></p>
                        </div>
    
    
                        <!-- ูุณู ููุงุญุธุงุช ุฅุถุงููุฉ (ูู ุงูุจุทุงูุฉ) -->
                        <div class="pt-4 grid grid-cols-1 sm:grid-cols-2 gap-4">
                             <div>
                                <span class="text-sm font-semibold text-gray-500">ุงูุจูุฆุฉ ุงูุตููุฉ:</span>
                                <p class="text-lg font-bold" id="report-organized-env"></p> <!-- ุณุชุชู ุชุนุจุฆุชูุง ุจู "ููุธูุฉ" ุฃู "ุบูุฑ ููุธูุฉ" -->
                            </div>
                            <div>
                                <span class="text-sm font-semibold text-gray-500">ููุงุญุธุงุช ุณูุจูุฉ (ุฎููู/ุนุจุซ):</span>
                                <p class="text-lg font-bold" id="report-negative-obs"></p> <!-- ุณุชุชู ุชุนุจุฆุชูุง ุจู "ูุนู" ุฃู "ูุง" -->
                            </div>
                        </div>
    
                        <!-- ูุณู ุงูุฑุณู ุงูุจูุงูู ููุดุงุท ุงูุทูุงุจ -->
                        <div class="pt-4">
                            <span class="text-sm font-semibold text-gray-500">ูุณุชูู ูุดุงุท ุงูุทูุงุจ:</span>
                            <div class="flex items-center space-x-3" dir="ltr">
                                <div class="w-full bg-gray-200 rounded-full h-5 overflow-hidden">
                                    <!-- ุชู ุชุนุฏูู ุงูุฃููุงู ูุงูุฃุญุฌุงู ูุชุนูุณ 4 ูุณุชููุงุช -->
                                    <div id="report-activity-bar" class="h-5 rounded-full transition-all duration-500 ease-out"></div>
                                </div>
                                <span class="text-lg font-bold" id="report-activity-value"></span>
                            </div>
                        </div>
    
                        <!-- ูุณู ูุคุดุฑ ุฌูุฏุฉ ุงูุชูุงุนู (ุงูุงุญุตุงุฆูุฉ) -->
                        <div class="pt-4">
                            <span class="text-sm font-semibold text-gray-500">ูุคุดุฑ ุฌูุฏุฉ ุงูุชูุงุนู:</span>
                            <div id="report-quality-indicator" class="p-3 rounded-lg mt-2">
                                <p id="report-quality-text" class="font-semibold text-center"></p>
                            </div>
                        </div>
    
                        <!-- ุฃุฒุฑุงุฑ ุงูุฅุบูุงู ูุงูุชุตุฏูุฑ -->
                        <div class="pt-4 grid grid-cols-2 gap-4">
                            <!-- ุฒุฑ ุงูุชุตุฏูุฑ -->
                            <button id="print-btn" class="w-full bg-green-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-green-700 transition duration-300 flex items-center justify-center gap-2">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                  <path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                                </svg>
                                <span>ุชุตุฏูุฑ PDF</span>
                            </button>
                            <!-- ุฒุฑ ุงูุนูุฏุฉ ูููููุฐุฌ -->
                            <button id="back-to-form-btn" class="w-full bg-gray-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-gray-600 transition duration-300">
                                ุงูุนูุฏุฉ ูููููุฐุฌ
                            </button>
                        </div>
                    </div>
                </div> <!-- ููุงูุฉ printable-card -->
            </main>
        </div>
    </div>

    <footer class="text-center text-gray-500 text-sm mt-4">
        ููุฑุฉ ูุชุตููู: ูุญูุฏ ูุฌููู
    </footer>


    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('observation-form');
            const errorMessage = document.getElementById('error-message');
            const printableCard = document.getElementById('printable-card'); // ุงูุจุทุงูุฉ ููุณูุง
            const mainContainer = document.getElementById('main-container').querySelector('.bg-white'); // ุงูุญุงููุฉ ุงูุฑุฆูุณูุฉ ูุชุบููุฑ ุงูุนุฑุถ

            // ุนูุงุตุฑ ุงูุฏุงุฆุฑุฉ
            const sectors = document.querySelectorAll('.sector');
            const activityValueInput = document.getElementById('student-activity-value');

            // ุนูุงุตุฑ ูุฑุจุนุงุช ุงูููุช
            const timeSegments = document.querySelectorAll('.time-segment');
            const timeSegmentValueInput = document.getElementById('time-segment-value');

            // ุนูุงุตุฑ ุฃุณููุจ ุงูุชุนูู
            const styleButtons = document.querySelectorAll('.style-btn');
            const learningStyleInput = document.getElementById('learning-style-value');

            // ุญูู ุงูููุงุญุธุงุช ุงููุตูุฉ
            const observerNotesInput = document.getElementById('observer-notes'); 

            // ุฃุฒุฑุงุฑ ุงูุชุญูู ุงูุฌุฏูุฏุฉ
            const printBtn = document.getElementById('print-btn');
            const backToFormBtn = document.getElementById('back-to-form-btn');
            
            // ุนูุงุตุฑ ุงูุชูุฑูุฑ
            const reportTeacher = document.getElementById('report-teacher');
            const reportSubject = document.getElementById('report-subject');
            const reportClass = document.getElementById('report-class');
            const reportTimeSegment = document.getElementById('report-time-segment');
            const reportEvent = document.getElementById('report-event');
            const reportStyle = document.getElementById('report-style');
            const reportOutput = document.getElementById('report-output'); 
            const reportActivityBar = document.getElementById('report-activity-bar');
            const reportActivityValue = document.getElementById('report-activity-value');
            const reportQualityIndicator = document.getElementById('report-quality-indicator');
            const reportQualityText = document.getElementById('report-quality-text');
            const reportObserverNotes = document.getElementById('report-observer-notes'); 

            // ุนูุงุตุฑ ุงูููุงุญุธุงุช ุงูุฅุถุงููุฉ
            const negativeObsCheckbox = document.getElementById('negative-observation');
            const organizedEnvCheckbox = document.getElementById('organized-env');
            const reportOrganizedEnv = document.getElementById('report-organized-env');
            const reportNegativeObs = document.getElementById('report-negative-obs');

            // ุฏุงูุฉ ุงูุชุญูู ูู ุงูุนุฑุถ (ุงููููุฐุฌ ููุงุจู ุงูุชูุฑูุฑ)
            function showForm() {
                form.classList.remove('hidden');
                printableCard.classList.add('hidden');
            }

            function showReport() {
                form.classList.add('hidden');
                printableCard.classList.remove('hidden');
            }

            // ุชููุฆุฉ: ุงุจุฏุฃ ุจุฅุธูุงุฑ ุงููููุฐุฌ ูุฅุฎูุงุก ุงูุจุทุงูุฉ (ูุฌุจ ุฃู ุชููู ุงูุจุทุงูุฉ ูุฎููุฉ ุจูุงุณุทุฉ CSS ุฃูุถุงู)
            showForm(); 

            // 1. ุงูุชุนุงูู ูุน ุงุฎุชูุงุฑ ุงููุทุงุน ุงูุฏุงุฆุฑู (ูุดุงุท ุงูุทูุงุจ)
            sectors.forEach(sector => {
                sector.addEventListener('click', (e) => {
                    sectors.forEach(s => s.classList.remove('sector-selected'));
                    const selectedSector = e.target.closest('.sector');
                    selectedSector.classList.add('sector-selected');
                    activityValueInput.value = selectedSector.dataset.value;
                    errorMessage.textContent = ''; 
                });
            });

            // 2. ุงูุชุนุงูู ูุน ุงุฎุชูุงุฑ ูุฑุจุนุงุช ุงูููุช
            timeSegments.forEach(segment => {
                segment.addEventListener('click', (e) => {
                    timeSegments.forEach(s => s.classList.remove('time-segment-selected'));
                    const selectedSegment = e.target.closest('.time-segment');
                    selectedSegment.classList.add('time-segment-selected');
                    timeSegmentValueInput.value = selectedSegment.dataset.value;
                    errorMessage.textContent = ''; 
                });
            });

            // 3. ุงูุชุนุงูู ูุน ุงุฎุชูุงุฑ ุฃุณููุจ ุงูุชุนูู
            styleButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    styleButtons.forEach(s => s.classList.remove('style-btn-selected'));
                    const selectedButton = e.target.closest('.style-btn');
                    selectedButton.classList.add('style-btn-selected');
                    learningStyleInput.value = selectedButton.dataset.value;
                    errorMessage.textContent = ''; 
                });
            });

            // ุฏุงูุฉ ุญุณุงุจ ุฌูุฏุฉ ุงูุชูุงุนู 
            function calculateQuality(activity, time, style, organized, negative, event, notes) {
                const lateTime = (time === 'ุฏ 31-40' || time === 'ุฏ 41-50');
                const midTime = (time === 'ุฏ 21-30');
                const earlyTime = (time === 'ุฏ 0-10' || time === 'ุฏ 11-20');

                let messages = []; 
                let color = 'yellow'; 
                
                // 1. ุงูุชุญููู ุงูุฃุณุงุณู: ุงููุดุงุท ููุงุจู ุงูุชูููุช
                
                if (activity === '75% - 100%') {
                    color = 'green';
                    if (lateTime) messages.push("ุชูุงุนู **ูุฐูู** (75% - 100%) ุญุชู ููุงูุฉ ุงูุญุตุฉ. **ููุทุฉ ููุฉ:** ุงูุญูุงุธ ุนูู ูุณุชูู ุนุงูู ูู ุงูุชุฑููุฒ ูุงูุฌุงุฐุจูุฉ ูู ุงููุฑุงุญู ุงููุชูุฏูุฉ ูู ุงูุฏุฑุณ.");
                    else if (earlyTime && style === 'ุบูุฑ ูุดุท') color = 'yellow'; // ุจุฏุงูุฉ ูููุฉ ุจุงูุชูููู ุฃูุฑ ุฌูุฏ ููู ููุณ ููุชุงุฒุงู
                    else messages.push("ุชูุงุนู ููู ูููุชุงุฒ (75% - 100%). **ุชูุตูุฉ:** ุงูุญูุงุธ ุนูู ุชููุน ุงูุฃูุดุทุฉ ูุชุฌูุจ ุงูุฑุชุงุจุฉ.");
                } else if (activity === '50% - 75%') {
                    color = 'yellow';
                    if (lateTime) messages.push("ุชูุงุนู **ุฌูุฏ** (50% - 75%)ุ ููู ููุญุธ ูุจูุท ุจุณูุท ูู ุงููุดุงุฑูุฉ ูุฑุจ ุงูููุงูุฉ. **ุชุญููู:** ูุฏ ูููู ุงูุชุนุจ ุฃู ุงูุฅุบุฑุงู ุจุงููุนูููุงุช ูู ุงูุณุจุจ.");
                    else if (midTime) messages.push("ุชูุงุนู ุนุงูู ูุณุจูุงู (50% - 75%) ูู ููุชุตู ุงูุญุตุฉ. **ุชูุตูุฉ:** ุฑูุน ูุชูุฑุฉ ุงูุฃุณุฆูุฉ ุฃู ุงูุงูุชูุงู ูุนูู ุชุนุงููู ูุฒูุงุฏุฉ ุงููุณุจุฉ.");
                    else messages.push("ุจุฏุงูุฉ ุฌูุฏุฉ (50% - 75%). **ุชูุตูุฉ:** ุงูุงุณุชุซูุงุฑ ูู ุฃูุดุทุฉ ุชุญุฏู ุฐูููุฉ ูุฑูุน ุงููุดุงุฑูุฉ ุฅูู 100%.");
                } else if (activity === '25% - 50%') {
                    color = 'red';
                    if (lateTime) messages.push("ุชูุงุนู **ุถุนูู** (25% - 50%) ููุงูุฉ ุงูุญุตุฉ. **ุชุญููู ุฎุทูุฑ:** ูุคุดุฑ ูุงุถุญ ุนูู ููุฏุงู ุงูุชุฑููุฒ. ูุฌุจ ูุฑุงุฌุนุฉ ุงูุฃูุดุทุฉ ุงููุชุจููุฉ.");
                    else if (earlyTime) messages.push("ุจุฏุงูุฉ ุถุนููุฉ (25% - 50%). **ุชุญููู ุฎุทูุฑ:** ูุฐุง ูุนูู ุฃู ุฑุจุน ุงูุทูุงุจ ููุท ููุฎุฑุท. **ุฅุฌุฑุงุก ููุชุฑุญ:** ุชุบููุฑ ุทุฑููุฉ ุงูุนุฑุถ ููุฑุงู.");
                    else messages.push("ุชูุงุนู ุถุนูู ูู ุงูููุชุตู. **ุฅุฌุฑุงุก ููุชุฑุญ:** ุงูุชุญูู ูู 'ููุงูุดุฉ ูุญูุงุฑ' ุฃู 'ูุดุงุท ุตูู' ููุณุฑ ุญุงุฌุฒ ุงูุฎููู.");
                } else { // < 25%
                    color = 'red';
                    messages.push("ุงูุชุจุงู **ููุฎูุถ ุฌุฏุงู** (< 25%). **ุชุญููู ูุงุฑุซู:** ุงูุฃุบูุจูุฉ ุงูุณุงุญูุฉ ุบูุฑ ููุฎุฑุทุฉ. **ุฅุฌุฑุงุก ุนุงุฌู:** ูุฌุจ ุฅููุงู ุงูุดุฑุญ ููุฑุงุฌุนุฉ ุงูุฃูุฏุงู ูุงูุฃุณููุจ ุงููุชุจุน.");
                }


                // 2. ุชุญููู ุงูุฃุณููุจ ูุงูุญุฏุซ ุงูุชุนูููู
                const isPassive = (style === 'ุบูุฑ ูุดุท' || event === 'ุงููุนูู ูููู ุงูุทูุงุจ ูุณุชูุนูู');
                const isDiscussion = (event === 'ููุงูุดุฉ ูุญูุงุฑ');

                if (isPassive) {
                    messages.push("ุชู ุงูุงุนุชูุงุฏ ุนูู ุฃุณููุจ **ุงูุชูููู/ุงูุนุฑุถ ุงููุจุงุดุฑ**.");
                    if (activity === '75% - 100%') messages.push("ููู ุฑุบู ุงูุชููููุ ุญุงูุธ ุงูุทูุงุจ ุนูู ุชุฑููุฒ ุนุงููุ ููุฐุง ุฏููู ุนูู ุฌูุฏุฉ ุฅููุงุก ุงููุนูู.");
                    if (activity === '< 25%') messages.push("ููุฐุง ุงูุฃุณููุจ (ุงูุชูููู) ูู ุงูุณุจุจ ุงููุฑุฌุญ ูุงูุฎูุงุถ ุงูุชูุงุนู ุจุดูู ูุจูุฑ.");
                }

                if (style === 'ูุดุท') {
                     if (activity === '< 25%') messages.push("ุชู ุชุทุจูู ุฃุณููุจ **ูุดุท**ุ ููู ุงููุชูุฌุฉ ูุงูุช ุนูุณูุฉ! ูุฌุจ ูุฑุงุฌุนุฉ ูุฏู ูุถูุญ ุงูุชุนูููุงุช ุฃู ุชุนููุฏ ุงููุดุงุท.");
                     if (activity === '50% - 75%' && !isDiscussion) messages.push("ุงูุชุทุจูู ุงููุดุท ุฌูุฏุ ูููู ุงูุชุฑููุฒ ุนูู (ูุฑู ุนูู/ุชุฌุฑุจุฉ) ุฑุจูุง ุดุชุช ุจุนุถ ุงูุทูุงุจ. **ุชูุตูุฉ:** ุฒูุงุฏุฉ ุนูุตุฑ ุงููุฑุงูุจุฉ ูุงููุชุงุจุนุฉ.");
                }
                
                if (isDiscussion && color !== 'green') {
                    messages.push("ููุญุธ 'ููุงูุดุฉ ูุญูุงุฑ'ุ ููู ุงูุชูุงุนู ูู ููู ููุชุงุฒุงู. **ุชุญููู:** ูุฏ ุชููู ุงูููุงูุดุฉ ููุชุตุฑุฉ ุนูู ุนุฏุฏ ูููู ูู ุงูุทูุงุจ.");
                }

                // 3. ุชุญููู ุงููุฎุฑุฌุงุช ูุงูุจูุฆุฉ (ุงูุชูุธูู ุงูุฐุงุชู)
                if (organized) {
                    messages.push("ุงูุจูุฆุฉ ุงูุตููุฉ **ููุธูุฉ**ุ ููุง ูุฏุนู ุงูุชุฑููุฒ.");
                } else {
                    messages.push("ุงูุจูุฆุฉ ุงูุตููุฉ **ุบูุฑ ููุธูุฉ**ุ ููุฐุง ูุฏ ูููู ูู ุชุฑููุฒ ุงูุทูุงุจ ููุฎูุถ ุงูุฌูุฏุฉ.");
                    if (color === 'green') color = 'yellow'; // ุชุฎููุถ ุชูููู ุงูุฌูุฏุฉ
                }

                // 4. ูุนุงูุฌุฉ ุงูููุงุญุธุงุช ุงูุฎุทูุฑุฉ 
                if (negative) {
                    messages.push("ุชู ุฑุตุฏ **ุฎููู/ุนุจุซ**ุ ููู ูุคุดุฑ ุญุฑุฌ ูุชุทูุจ ูุนุงูุฌุฉ ููุฑูุฉ. ุชู ุชุซุจูุช ุงูุชูููู ุนูู **ุฃุญูุฑ**.");
                    color = 'red'; 
                }
                
                // 5. ุฏูุฌ ุงูููุงุญุธุงุช ุงููุตูุฉ
                if (notes && notes.trim().length > 0) {
                    messages.push(`**ุชุนููู ุฅุถุงูู ูู ุงูุฒุงุฆุฑ:** "${notes.trim()}"`);
                }

                // ุชุฌููุน ูู ุงูุฑุณุงุฆู ูู ุฑุณุงูุฉ ูุงุญุฏุฉ
                let finalText = messages.join('\n\n- ');
                if (finalText.length === 0) finalText = "ุชู ุชุณุฌูู ุงูููุงุญุธุฉุ ูุงููุคุดุฑุงุช ุจุญุงุฌุฉ ูุชุญููู ูุฏูู."; 
                
                // ุฅุถุงูุฉ ุนููุงู ููุชุบุฐูุฉ ุงูุฑุงุฌุนุฉ
                finalText = `**ุชุญููู ุงููุคุดุฑ:**\n\n- ${finalText}`;


                return { text: finalText, color: color };
            }

            // 4. ุงูุชุนุงูู ูุน ุชุณุฌูู ุงูููุงุญุธุฉ (Submit)
            form.addEventListener('submit', (e) => {
                e.preventDefault(); 

                // ุฌูุจ ุงูุจูุงูุงุช
                const teacherName = document.getElementById('teacher-name').value;
                const subject = document.getElementById('subject').value;
                const className = document.getElementById('class-name').value;
                const location = document.getElementById('location').value;
                const learningEvent = document.getElementById('learning-event').value;
                const lessonOutput = document.getElementById('lesson-output').value; 
                const studentActivity = activityValueInput.value;
                const timeSegment = timeSegmentValueInput.value;
                const learningStyle = learningStyleInput.value;
                const observerNotes = observerNotesInput.value; 
                
                // ุฌูุจ ุจูุงูุงุช ุงูููุงุญุธุงุช ุงูุฅุถุงููุฉ
                const negativeObs = negativeObsCheckbox.checked;
                const organizedEnv = organizedEnvCheckbox.checked;


                // ุงูุชุญูู ูู ุงูุจูุงูุงุช
                if (!teacherName || !subject || !className) {
                    errorMessage.textContent = 'ุงูุฑุฌุงุก ุชุนุจุฆุฉ ุญููู ุงููุนูู ูุงููุงุฏุฉ ูุงููุตู.';
                    return;
                }
                if (!timeSegment) {
                    errorMessage.textContent = 'ุงูุฑุฌุงุก ุงุฎุชูุงุฑ ุชูููุช ุงูุฑุตุฏ ูู ุงููุฑุจุนุงุช.';
                    return;
                }
                 if (!learningStyle) {
                    errorMessage.textContent = 'ุงูุฑุฌุงุก ุงุฎุชูุงุฑ ุฃุณููุจ ุงูุชุนูู.';
                    return;
                }
                if (!studentActivity) {
                    errorMessage.textContent = 'ุงูุฑุฌุงุก ุงุฎุชูุงุฑ ูุณุจุฉ ูุดุงุท ุงูุทูุงุจ ูู ุงูุฏุงุฆุฑุฉ.';
                    return;
                }
                // ูุง ูุญุชุงุฌ ุงูุชุญูู ูู ูุฎุฑุฌุงุช ุงูุญุตุฉ ูุฃู ููุง ูููุฉ ุงูุชุฑุงุถูุฉ "ูุง ููุฌุฏ"

                // --- ุชุนุจุฆุฉ ูุนุฑุถ ุงูุจุทุงูุฉ (ุงูุขู ุชุธูุฑ ูู ุงูุตูุญุฉ ูุจุงุดุฑุฉ) ---
                
                // ุชุนุจุฆุฉ ุงูุจูุงูุงุช
                reportTeacher.textContent = teacherName;
                reportSubject.textContent = subject;
                reportClass.textContent = className;
                reportTimeSegment.textContent = timeSegment;
                reportEvent.textContent = learningEvent;
                reportStyle.textContent = learningStyle;
                reportOutput.textContent = lessonOutput; 
                reportActivityValue.textContent = studentActivity;
                reportObserverNotes.textContent = observerNotes; 

                // ุชุนุจุฆุฉ ุจูุงูุงุช ุงูููุงุญุธุงุช ุงูุฅุถุงููุฉ ูู ุงูุจุทุงูุฉ
                reportOrganizedEnv.textContent = organizedEnv ? "ููุธูุฉ" : "ุบูุฑ ููุธูุฉ";
                reportOrganizedEnv.className = organizedEnv ? "text-lg font-bold text-green-600" : "text-lg font-bold text-red-600";
                reportNegativeObs.textContent = negativeObs ? "ุชู ููุงุญุธุชูุง" : "ูุง ููุฌุฏ";
                reportNegativeObs.className = negativeObs ? "text-lg font-bold text-red-600" : "text-lg font-bold text-green-600";


                // ุชุญุฏูุซ ุดุฑูุท ุงูุฑุณู ุงูุจูุงูู (4 ูุณุชููุงุช ุฌุฏูุฏุฉ)
                reportActivityBar.classList.remove('bg-green-500', 'bg-yellow-400', 'bg-red-500', 'bg-red-700', 'w-full', 'w-3/4', 'w-1/2', 'w-1/4');
                if (studentActivity === '75% - 100%') {
                    reportActivityBar.classList.add('bg-green-500', 'w-full');
                } else if (studentActivity === '50% - 75%') {
                    reportActivityBar.classList.add('bg-yellow-400', 'w-3/4');
                } else if (studentActivity === '25% - 50%') {
                    reportActivityBar.classList.add('bg-red-500', 'w-1/2');
                } else { // < 25%
                    reportActivityBar.classList.add('bg-red-700', 'w-1/4');
                }

                // ุชุญุฏูุซ ูุคุดุฑ ุฌูุฏุฉ ุงูุชูุงุนู 
                const quality = calculateQuality(studentActivity, timeSegment, learningStyle, organizedEnv, negativeObs, learningEvent, observerNotes);
                // ุงุณุชุฎุฏุงู innerHTML ููุณูุงุญ ุจุงูู bold ูุงูุฃุณุทุฑ ุงูุฌุฏูุฏุฉ
                reportQualityText.innerHTML = quality.text.replace(/\n/g, '<br>'); 
                reportQualityIndicator.classList.remove('bg-green-100', 'text-green-800', 'bg-yellow-100', 'text-yellow-800', 'bg-red-100', 'text-red-800');
                if (quality.color === 'green') {
                    reportQualityIndicator.classList.add('bg-green-100', 'text-green-800');
                } else if (quality.color === 'yellow') {
                    reportQualityIndicator.classList.add('bg-yellow-100', 'text-yellow-800');
                } else {
                    reportQualityIndicator.classList.add('bg-red-100', 'text-red-800');
                }

                // *** ุฅุธูุงุฑ ุงูุจุทุงูุฉ ูุฅุฎูุงุก ุงููููุฐุฌ ***
                showReport();
                // ุงูุชูุฑูุฑ ูุฃุนูู ุงูุจุทุงูุฉ ุงูุฌุฏูุฏุฉ
                printableCard.scrollIntoView({ behavior: 'smooth' });

                // --- ุฅุนุงุฏุฉ ุชุนููู ุงูููุฑู ---
                form.reset();
                activityValueInput.value = '';
                timeSegmentValueInput.value = '';
                learningStyleInput.value = '';
                observerNotesInput.value = ''; 
                document.getElementById('lesson-output').value = 'ูุง ููุฌุฏ'; 
                document.getElementById('class-name').value = ''; 
                
                // ุฅุนุงุฏุฉ ุชุนููู ุงูููุงุญุธุงุช ุงูุฅุถุงููุฉ
                negativeObsCheckbox.checked = false;
                organizedEnvCheckbox.checked = false;

                sectors.forEach(s => s.classList.remove('sector-selected'));
                timeSegments.forEach(s => s.classList.remove('time-segment-selected'));
                styleButtons.forEach(s => s.classList.remove('style-btn-selected'));
                errorMessage.textContent = '';
            });

            // 5. ุฒุฑ ุงูุนูุฏุฉ ูููููุฐุฌ
            backToFormBtn.addEventListener('click', () => {
                showForm();
                // ุงูุชูุฑูุฑ ูุฃุนูู ุงููููุฐุฌ ุงูุฌุฏูุฏ
                mainContainer.scrollIntoView({ behavior: 'smooth' });
            });

            // 6. ุงูุชุนุงูู ูุน ุฒุฑ ุงูุทุจุงุนุฉ (ุชุตุฏูุฑ PDF)
            printBtn.addEventListener('click', () => {
                // 1. ุฅุฎูุงุก ุงูุฃุฒุฑุงุฑ ูุชุบููุฑ ุงููุต ูุฅุธูุงุฑ ุงูุชุญููู
                const originalText = printBtn.innerHTML;
                printBtn.innerHTML = '<span class="animate-pulse">ุฌุงุฑู ุงูุฅูุดุงุก...</span>';
                printBtn.disabled = true;
                backToFormBtn.classList.add('hidden'); // ุฅุฎูุงุก ุฒุฑ ุงูุนูุฏุฉ ูุคูุชุงู
                
                const cardToExport = document.getElementById('printable-card');
                const { jsPDF } = window.jspdf;

                // 2. ุงูุชูุงุท ุตูุฑุฉ ูุงููุฉ ููุจุทุงูุฉ
                html2canvas(cardToExport, {
                    scale: 2, // ุฒูุงุฏุฉ ุงูุฏูุฉ
                    useCORS: true,
                }).then(canvas => {
                    const imgData = canvas.toDataURL('image/png');
                    
                    const pdf = new jsPDF('p', 'mm', 'a4');
                    const pdfWidth = pdf.internal.pageSize.getWidth(); // 210mm
                    const pdfHeight = pdf.internal.pageSize.getHeight(); // 297mm

                    const margin = 10;
                    const contentWidth = pdfWidth - (2 * margin);
                    
                    const imgProps = pdf.getImageProperties(imgData);
                    // ุงูุงุฑุชูุงุน ุงูููู ููุตูุฑุฉ scaled ุฅูู ุนุฑุถ PDF
                    const imgHeight = (imgProps.height * contentWidth) / imgProps.width; 

                    const pageHeight = pdfHeight - (2 * margin); // ุงูุงุฑุชูุงุน ุงููุชุงุญ ูู ุงูุตูุญุฉ ุงููุงุญุฏุฉ
                    let heightLeft = imgHeight; // ุงูุงุฑุชูุงุน ุงููุชุจูู ูู ุงูุตูุฑุฉ

                    let position = 0; // ููุถุน ูุต ุงูุตูุฑุฉ
                    
                    // 1. ุฅุถุงูุฉ ุงูุตูุญุฉ ุงูุฃููู
                    pdf.addImage(imgData, 'PNG', margin, margin, contentWidth, imgHeight);
                    heightLeft -= pageHeight;
                    position -= pageHeight;

                    // 2. ุฅุถุงูุฉ ุงูุตูุญุงุช ุงูุชุงููุฉ ุทุงููุง ุจูู ุงุฑุชูุงุน
                    while (heightLeft > 0) {
                        pdf.addPage();
                        
                        // ุญุณุงุจ ุงูููุถุน ุงูุฑุฃุณู ููุตูุฑุฉ ูู "ุฅุฒุงุญุฉ" ุงูุฌุฒุก ุงูุฐู ุชู ุนุฑุถู
                        const imageYOffset = position + margin; 
                        
                        // ูุชู ุฅุถุงูุฉ ุงูุตูุฑุฉ ูุงููุฉุ ููู jsPDF ูููู ุจูุตูุง ุชููุงุฆูุงู ูุนุฑุถ ุงูุฌุฒุก ุงููุทููุจ ููุท
                        pdf.addImage(imgData, 'PNG', margin, imageYOffset, contentWidth, imgHeight);
                        
                        heightLeft -= pageHeight;
                        position -= pageHeight;
                    }

                    // 4. ุญูุธ ุงูููู
                    pdf.save('ุจุทุงูุฉ-ููุงุญุธุฉ-ุตููุฉ.pdf');

                }).finally(() => {
                    // 5. ุฅุนุงุฏุฉ ุงูุฃุฒุฑุงุฑ ูุญุงูุชูุง ุงูุทุจูุนูุฉ ุจุนุฏ ุงูุชูุงุก ุงูุนูููุฉ
                    printBtn.innerHTML = originalText;
                    printBtn.disabled = false;
                    backToFormBtn.classList.remove('hidden'); // ุฅุนุงุฏุฉ ุฅุธูุงุฑ ุฒุฑ ุงูุนูุฏุฉ
                });
            });
        });
    </script>
</body>
</html>