<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>حقيبة الأنشطة الصفية - المعلمة حياة الغامدي</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Tajawal', sans-serif; background-color: #f0f2f5; }
        .gradient-header { background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%); }
        .activity-card { transition: all 0.3s ease; border: 1px solid #e5e7eb; }
        .activity-card:hover { box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1); border-color: #3b82f6; }
        .procedural-step { position: relative; padding-right: 20px; }
        .procedural-step::before { content: '•'; position: absolute; right: 0; color: #3b82f6; font-weight: bold; }
        input[type="date"], input[type="text"] { border: 2px solid #d1d5db; transition: border-color 0.3s; }
        input[type="date"]:focus, input[type="text"]:focus { border-color: #3b82f6; outline: none; }
    </style>
</head>
<body class="text-gray-800">

    <header class="gradient-header text-white shadow-2xl sticky top-0 z-50">
        <div class="container mx-auto px-6 py-4 flex flex-col md:flex-row justify-between items-center">
            <div class="flex items-center space-x-4 space-x-reverse mb-4 md:mb-0">
                <i class="fas fa-chalkboard-teacher text-4xl animate__animated animate__pulse animate__infinite"></i>
                <div>
                    <h1 class="text-3xl font-extrabold">حقيبة الأنشطة الصفية التفاعلية</h1>
                    <p class="text-blue-200 opacity-90">منصة العرض والتقييم داخل الحصة</p>
                </div>
            </div>
            <div class="bg-white/10 backdrop-blur-md px-6 py-3 rounded-2xl flex items-center gap-4 border border-white/20">
                <i class="fas fa-trophy text-yellow-400 text-2xl"></i>
                <div class="text-center">
                    <span class="block text-sm text-blue-200">مجموع نقاط الفصل</span>
                    <span id="pointsDisplay" class="text-3xl font-bold text-yellow-300">0</span>
                </div>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8 flex flex-col lg:flex-row gap-8">
        
        <aside class="lg:w-1/5 hidden lg:block">
            <div class="bg-white rounded-2xl shadow-lg p-6 sticky top-28">
                <h3 class="font-bold text-xl mb-6 text-gray-700 flex items-center gap-2">
                    <i class="fas fa-list-ul"></i> فهرس الوحدات
                </h3>
                <nav class="space-y-2">
                    <a href="#section-space" class="flex items-center gap-3 p-3 rounded-lg hover:bg-orange-50 text-gray-700 hover:text-orange-600 transition-all group">
                        <i class="fas fa-rocket group-hover:rotate-12 transition-transform"></i> الوحدة 4: الفضاء
                    </a>
                    <a href="#section-matter" class="flex items-center gap-3 p-3 rounded-lg hover:bg-blue-50 text-gray-700 hover:text-blue-600 transition-all group">
                        <i class="fas fa-flask group-hover:rotate-12 transition-transform"></i> الوحدة 5: المادة
                    </a>
                    <a href="#section-forces" class="flex items-center gap-3 p-3 rounded-lg hover:bg-cyan-50 text-gray-700 hover:text-cyan-600 transition-all group">
                        <i class="fas fa-bolt group-hover:rotate-12 transition-transform"></i> الوحدة 6: القوى والطاقة
                    </a>
                </nav>
                <button onclick="exportToPDF()" class="mt-8 w-full bg-green-600 text-white py-3 rounded-xl hover:bg-green-700 flex items-center justify-center gap-2 transition shadow-md hover:shadow-lg">
                    <i class="fas fa-file-pdf text-xl"></i> تصدير سجل الحصة (PDF)
                </button>
            </div>
        </aside>

        <section id="mainContent" class="lg:w-4/5 space-y-16">
            </section>
    </main>

    <footer class="bg-gray-800 text-gray-300 py-8 mt-20 relative overflow-hidden">
        <div class="absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]"></div>
        <div class="container mx-auto px-6 text-center relative z-10">
            <h2 class="text-2xl font-bold text-white mb-2">المملكة العربية السعودية - وزارة التعليم</h2>
            <p class="text-lg mb-4">حقيبة الأنشطة الصفية والإثرائية - لمادة العلوم</p>
            <div class="inline-block bg-blue-900/50 px-6 py-3 rounded-full border border-blue-500/30">
                 <p class="text-blue-300 font-bold text-xl flex items-center justify-center gap-3">
                    <i class="fas fa-user-tie"></i> إعداد وتنفيذ المعلمة: حياة الغامدي
                </p>
            </div>
            <p class="text-sm mt-6 opacity-60">جميع الحقوق محفوظة &copy; 2024</p>
        </div>
    </footer>

    <script>
        // --- Data Structure for Activities ---
        const activitiesData = [
            {
                id: 'section-space',
                title: 'الوحدة الرابعة: الفضاء',
                themeColor: 'orange',
                icon: 'fa-rocket',
                activities: [
                    {
                        id: 'act-space-1',
                        title: 'نمذجة تعاقب الليل والنهار',
                        icon: 'fa-globe-africa',
                        image: 'https://images.unsplash.com/photo-1614732414444-096e6f655b56?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80',
                        procedure: [
                            'استخدام مجسم للكرة الأرضية ومصباح يدوي (يمثل الشمس).',
                            'تظليم الغرفة وتركيز ضوء المصباح على جانب واحد من الكرة.',
                            'تدوير الكرة الأرضية ببطء عكس عقارب الساعة.',
                            'مطالبة الطالبات بتحديد المناطق التي تعيش النهار والمناطق التي تعيش الليل أثناء الدوران.'
                        ],
                        points: 50
                    },
                    {
                        id: 'act-space-2',
                        title: 'محاكاة أطوار القمر (صندوق القمر)',
                        icon: 'fa-moon',
                        image: 'https://images.unsplash.com/photo-1532693322450-2cb5c511067d?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80',
                        procedure: [
                            'استخدام صندوق كرتوني مفتوح من جهة، وكرة بيضاء صغيرة معلقة بداخله.',
                            'عمل ثقوب في جوانب الصندوق المختلفة للنظر منها.',
                            'تسليط ضوء مصباح على الكرة من فتحة جانبية ثابتة.',
                            'جعل الطالبة تنظر من الثقوب المختلفة لرؤية كيف يتغير الجزء المضاء من الكرة (محاكاة الأطوار).'
                        ],
                        points: 75
                    },
                    {
                        id: 'act-space-3',
                        title: 'مقارنة أحجام الكواكب (النموذج السلمي)',
                        icon: 'fa-solar-system',
                        image: 'https://images.unsplash.com/photo-1614313511387-1436a4480ebb?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80',
                        procedure: [
                            'استخدام فواكه أو كرات بأحجام مختلفة لتمثيل الكواكب (مثلاً: بطيخة للمشتري، برتقالة للأرض، عنبة لعطارد).',
                            'عرض الصور الحقيقية للكواكب بجانب النماذج.',
                            'مناقشة الفرق الهائل في الحجم بين الكواكب الداخلية والخارجية والشمس.',
                            'ترتيب النماذج حسب بعدها عن الشمس.'
                        ],
                        points: 60
                    }
                ]
            },
            {
                id: 'section-matter',
                title: 'الوحدة الخامسة: المادة',
                themeColor: 'blue',
                icon: 'fa-flask',
                activities: [
                    {
                        id: 'act-matter-1',
                        title: 'مختبر الكثافة: برج السوائل الملون',
                        icon: 'fa-vial',
                        image: 'https://images.unsplash.com/photo-1626887066721-806e92006867?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80',
                        procedure: [
                            'إحضار سوائل مختلفة الكثافة (عسل، صابون سائل ملون، ماء ملون، زيت).',
                            'سكب السوائل ببطء وحذر شديد في أنبوب زجاجي طويل، بدءاً بالأكثر كثافة (العسل).',
                            'ملاحظة كيف تطفو السوائل فوق بعضها البعض دون أن تختلط.',
                            'إسقاط أجسام صغيرة (مسمار، قطعة بلاستيك) وملاحظة أين تستقر.'
                        ],
                        points: 80
                    },
                    {
                        id: 'act-matter-2',
                        title: 'فصل المخاليط: تحدي التنقية',
                        icon: 'fa-filter',
                        image: 'https://plus.unsplash.com/premium_photo-1676320877930-cfb03c8f1664?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80',
                        procedure: [
                            'تجهيز مخلوط معقد (ماء + رمل + ملح + برادة حديد).',
                            'استخدام المغناطيس أولاً لفصل برادة الحديد.',
                            'استخدام ورقة الترشيح والقمع لفصل الرمل عن الماء المالح.',
                            'مناقشة طريقة فصل الملح المذاب (التبخير) كخطوة نظرية أخيرة.'
                        ],
                        points: 70
                    },
                    {
                        id: 'act-matter-3',
                        title: 'دلائل التغير الكيميائي: البالون المنتفخ',
                        icon: 'fa-bacterium',
                        image: 'https://images.unsplash.com/photo-1581093588401-fbb62a02f120?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80',
                        procedure: [
                            'وضع كمية من بيكربونات الصوديوم داخل بالون غير منفوخ.',
                            'وضع كمية من الخل في قارورة بلاستيكية فارغة.',
                            'تثبيت فوهة البالون على فوهة القارورة بحذر.',
                            'رفع البالون للأعلى ليسقط المسحوق داخل الخل، وملاحظة تصاعد الغاز وانتفاخ البالون كدليل على التغير الكيميائي.'
                        ],
                        points: 90
                    }
                ]
            },
            {
                id: 'section-forces',
                title: 'الوحدة السادسة: القوى والطاقة',
                themeColor: 'cyan',
                icon: 'fa-bolt',
                activities: [
                    {
                        id: 'act-force-1',
                        title: 'تأثير الاحتكاك على الحركة',
                        icon: 'fa-road',
                        image: 'https://images.unsplash.com/photo-1598599678963-5f7574863094?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80',
                        procedure: [
                            'استخدام سيارة لعبة صغيرة ومنحدر بسيط.',
                            'تجهيز أسطح مختلفة في نهاية المنحدر (سجادة خشنة، بلاط أملس، ورقة صنفرة).',
                            'إطلاق السيارة من نفس الارتفاع على كل سطح.',
                            'قياس المسافة التي تقطعها السيارة في كل مرة ومناقشة دور قوة الاحتكاك في إيقافها.'
                        ],
                        points: 65
                    },
                    {
                        id: 'act-force-2',
                        title: 'بناء دائرة كهربائية (المفتاح الذكي)',
                        icon: 'fa-lightbulb',
                        image: 'https://images.unsplash.com/photo-1581092160562-40aa08e78837?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80',
                        procedure: [
                            'توفير بطارية، أسلاك توصيل، مصباح صغير، ومشابك ورق.',
                            'تحدي الطالبات لبناء دائرة يضيء فيها المصباح.',
                            'استخدام مشبكي ورق وقطعة كرتون لابتكار "مفتاح كهربائي" بسيط لفتح وإغلاق الدائرة.',
                            'رسم مخطط للدائرة الكهربائية التي تم تنفيذها.'
                        ],
                        points: 100
                    },
                    {
                        id: 'act-force-3',
                        title: 'المغناطيس الكهربائي (الرافعة القوية)',
                        icon: 'fa-magnet',
                        image: 'https://images.unsplash.com/photo-1546625552-5a69a804e937?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80',
                        procedure: [
                            'لف سلك نحاسي معزول حول مسمار حديدي كبير عدة لفات.',
                            'توصيل طرفي السلك ببطارية.',
                            'تقريب المسمار من مشابك حديدية صغيرة وملاحظة تحوله لمغناطيس.',
                            'تجربة زيادة عدد اللفات أو استخدام بطارية أقوى وملاحظة تأثير ذلك على قوة الجذب.'
                        ],
                        points: 85
                    }
                ]
            }
        ];

        // --- Rendering Logic ---
        function renderActivities() {
            const container = document.getElementById('mainContent');
            let htmlContent = '';

            activitiesData.forEach(section => {
                const bgColor = `bg-${section.themeColor}-100`;
                const textColor = `text-${section.themeColor}-700`;
                const borderColor = `border-${section.themeColor}-500`;

                htmlContent += `
                    <div id="${section.id}" class="animate__animated animate__fadeIn">
                        <div class="flex items-center gap-4 mb-8 p-4 rounded-2xl ${bgColor} ${borderColor} border-r-8 shadow-sm">
                            <div class="bg-white p-3 rounded-full shadow-md">
                                <i class="fas ${section.icon} fa-2x ${textColor}"></i>
                            </div>
                            <h2 class="text-3xl font-bold ${textColor}">${section.title}</h2>
                        </div>
                        <div class="grid gap-8">
                `;

                section.activities.forEach(act => {
                    htmlContent += `
                        <div class="activity-card bg-white rounded-3xl overflow-hidden shadow-md" id="${act.id}">
                            <div class="relative h-72 md:h-96 overflow-hidden">
                                <img src="${act.image}" alt="${act.title}" class="w-full h-full object-cover transform hover:scale-105 transition-transform duration-700">
                                <div class="absolute bottom-0 right-0 bg-gradient-to-t from-black/80 to-transparent w-full p-6 pt-20">
                                    <h3 class="text-2xl md:text-3xl font-bold text-white flex items-center gap-3">
                                        <i class="fas ${act.icon} text-${section.themeColor}-300"></i> ${act.title}
                                    </h3>
                                </div>
                                <div class="absolute top-4 left-4 bg-yellow-400 text-gray-900 font-bold px-4 py-2 rounded-full shadow-lg">
                                    ${act.points}+ نقطة
                                </div>
                            </div>
                            
                            <div class="p-6 md:p-8">
                                <div class="mb-8 bg-gray-50 p-6 rounded-2xl border-r-4 ${borderColor}">
                                    <h4 class="font-bold text-xl mb-4 text-gray-800 flex items-center gap-2">
                                        <i class="fas fa-clipboard-list text-${section.themeColor}-600"></i> الوصف الإجرائي للتنفيذ:
                                    </h4>
                                    <ul class="space-y-3 text-lg text-gray-700 leading-relaxed">
                                        ${act.procedure.map(step => `<li class="procedural-step">${step}</li>`).join('')}
                                    </ul>
                                </div>

                                <div class="bg-blue-50/50 p-6 rounded-2xl border border-blue-100 mb-6 input-area">
                                    <h4 class="font-bold text-gray-700 mb-4 flex items-center gap-2"><i class="fas fa-user-edit"></i> توثيق التنفيذ:</h4>
                                    <div class="grid md:grid-cols-2 gap-4">
                                        <div>
                                            <label class="block text-sm font-bold text-gray-600 mb-2">تاريخ التنفيذ:</label>
                                            <input type="date" class="w-full p-3 rounded-xl bg-white shadow-sm date-input">
                                        </div>
                                        <div>
                                            <label class="block text-sm font-bold text-gray-600 mb-2">اسم الطالبة / المجموعة المشاركة:</label>
                                            <input type="text" placeholder="اكتبي الاسم هنا..." class="w-full p-3 rounded-xl bg-white shadow-sm student-input">
                                        </div>
                                    </div>
                                </div>

                                <button onclick="completeTaskWithDetails(this, ${act.points})" class="complete-btn w-full bg-gradient-to-r from-${section.themeColor}-600 to-${section.themeColor}-500 text-white font-bold text-xl py-4 rounded-2xl hover:shadow-lg hover:from-${section.themeColor}-700 transition-all flex items-center justify-center gap-3">
                                    <i class="fas fa-check-circle text-2xl"></i> إتمام النشاط ورصد النقاط
                                </button>
                            </div>
                        </div>
                    `;
                });

                htmlContent += `</div></div>`;
            });

            container.innerHTML = htmlContent;
            // Set default date to today for convenience
            document.querySelectorAll('.date-input').forEach(input => {
                input.valueAsDate = new Date();
            });
        }

        // --- Gamification & Validation Logic ---
        let totalPoints = 0;

        function completeTaskWithDetails(buttonBtn, points) {
            const card = buttonBtn.closest('.activity-card');
            const studentInput = card.querySelector('.student-input');
            const dateInput = card.querySelector('.date-input');
            const inputArea = card.querySelector('.input-area');
            const studentName = studentInput.value.trim();
            const dateValue = dateInput.value;

            // Validation: Ensure student name is entered
            if (studentName === "") {
                Swal.fire({
                    icon: 'warning',
                    title: 'بيانات ناقصة!',
                    text: 'الرجاء كتابة اسم الطالبة أو المجموعة قبل رصد النقاط.',
                    confirmButtonText: 'حسناً',
                    confirmButtonColor: '#3b82f6'
                });
                studentInput.focus();
                return;
            }

            // Success Flow
            totalPoints += points;
            updatePointsDisplay();

            // UI Feedback
            buttonBtn.innerHTML = `<i class="fas fa-check-double"></i> تم الرصد بنجاح (${studentName})`;
            buttonBtn.classList.remove('from-orange-600', 'to-orange-500', 'from-blue-600', 'to-blue-500', 'from-cyan-600', 'to-cyan-500');
            buttonBtn.classList.add('bg-green-600', 'cursor-not-allowed', 'opacity-90');
            buttonBtn.disabled = true;
            
            // Lock inputs to prevent changes after submission
            studentInput.disabled = true;
            dateInput.disabled = true;
            inputArea.classList.add('opacity-70', 'bg-gray-100');

            Swal.fire({
                icon: 'success',
                title: `أحسنتِ يا ${studentName}!`,
                html: `تم إنجاز النشاط بتاريخ <span class="font-bold">${dateValue}</span><br>وإضافة <span class="text-yellow-500 font-bold text-xl">${points}+</span> نقطة لرصيد الفصل.`,
                timer: 3000,
                timerProgressBar: true,
                showConfirmButton: false,
                background: '#f0fdf4'
            });
        }

        function updatePointsDisplay() {
            const pointsElement = document.getElementById('pointsDisplay');
            pointsElement.innerText = totalPoints;
            pointsElement.classList.add('animate__animated', 'animate__heartBeat');
            setTimeout(() => {
                pointsElement.classList.remove('animate__heartBeat');
            }, 1000);
        }

        // --- PDF Export Logic ---
        function exportToPDF() {
            // Temporarily show hidden sidebar for PDF print if needed, or focus on main content.
            // For a clean classroom log, we will export the main content area.
            const element = document.getElementById('mainContent');
            
            Swal.fire({
                title: 'جاري تحضير سجل الحصة...',
                html: 'يتم الآن إنشاء ملف PDF يحتوي على كافة الأنشطة الموثقة.',
                timerProgressBar: true,
                didOpen: () => { Swal.showLoading(); }
            });

            const opt = {
                margin: [0.5, 0.5, 0.5, 0.5], // top, left, bottom, right
                filename: `سجل_انشطة_العلوم_${new Date().toLocaleDateString('ar-SA').replace(/\//g, '-')}.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { 
                    scale: 2, // Higher scale for better image quality
                    useCORS: true, // Important for loading external images
                    scrollY: 0
                },
                jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' },
                pagebreak: { mode: ['avoid-all', 'css', 'legacy'] } // Avoid breaking cards across pages
            };

            // Small delay to ensure UI changes (like disabled inputs) are rendered before capture
            setTimeout(() => {
                html2pdf().set(opt).from(element).save().then(() => {
                    Swal.close();
                    Swal.fire({
                        icon:'success',
                        title:'تم التصدير بنجاح!',
                        confirmButtonText: 'ممتاز',
                        confirmButtonColor: '#10b981'
                    });
                });
            }, 500);
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', renderActivities);
    </script>
</body>
</html>